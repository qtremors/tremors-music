[{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\App.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'location.pathname'. Either include it or remove the dependency array.","line":44,"column":6,"nodeType":"ArrayExpression","endLine":44,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [search, navigate, location.pathname]","fix":{"range":[1946,1964],"text":"[search, navigate, location.pathname]"}}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\App.tsx:48:7\n  46 |   useEffect(() => {\n  47 |     if (location.pathname !== '/search') {\n> 48 |       setSearch('');\n     |       ^^^^^^^^^ Avoid calling setState() directly within an effect\n  49 |     }\n  50 |   }, [location.pathname]);\n  51 |","line":48,"column":7,"nodeType":null,"endLine":48,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { BrowserRouter, Routes, Route, NavLink, useNavigate, useLocation } from 'react-router-dom';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { AnimatePresence } from 'framer-motion';\r\nimport { ErrorBoundary } from './components/ErrorBoundary';\r\nimport { LibraryPage } from './pages/LibraryPage';\r\nimport { SearchPage } from './pages/SearchPage';\r\nimport { AlbumsPage } from './pages/AlbumsPage';\r\nimport { AlbumDetail } from './pages/AlbumDetail';\r\nimport { ArtistsPage } from './pages/ArtistsPage';\r\nimport { AllPlaylistsPage } from './pages/AllPlaylistsPage';\r\nimport { PlaylistDetail } from './pages/PlaylistDetail';\r\nimport { SettingsPage } from './pages/SettingsPage';\r\nimport { Player } from './components/Player';\r\nimport { ArtistDetail } from './pages/ArtistDetail';\r\nimport { ToastContainer } from './components/ToastContainer';\r\nimport { ConfirmDialog } from './components/ConfirmDialog';\r\nimport { CreatePlaylistModal } from './components/CreatePlaylistModal';\r\nimport { getPlaylists } from './lib/api';\r\nimport { cn } from './lib/utils';\r\nimport {\r\n  Library, Settings, Disc, Mic2, Music,\r\n  PlusCircle, ListMusic, Search\r\n} from 'lucide-react';\r\nimport { useKeyboardShortcuts } from './hooks/useKeyboardShortcuts';\r\n\r\n// --- Sidebar Component ---\r\nfunction Sidebar({ setIsCreatingPlaylist }: { setIsCreatingPlaylist: (val: boolean) => void }) {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [search, setSearch] = useState('');\r\n\r\n  const { data: playlists } = useQuery({ queryKey: ['playlists'], queryFn: getPlaylists });\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      if (search.trim()) {\r\n        navigate(`/search?q=${encodeURIComponent(search)}`);\r\n      } else if (location.pathname === '/search' && !search.trim()) {\r\n        navigate('/');\r\n      }\r\n    }, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [search, navigate]);\r\n\r\n  useEffect(() => {\r\n    if (location.pathname !== '/search') {\r\n      setSearch('');\r\n    }\r\n  }, [location.pathname]);\r\n\r\n  return (\r\n    <div className=\"fixed top-0 left-0 w-64 h-full pb-28 bg-gray-50/80 dark:bg-black/50 border-r border-gray-200 dark:border-white/10 hidden lg:flex flex-col p-6 z-20 backdrop-blur-xl\">\r\n\r\n      <div className=\"mb-6 px-2 flex-shrink-0\">\r\n        <h1 className=\"text-2xl font-bold text-apple-accent flex items-center gap-2 mb-6 select-none\">\r\n          <Library /> Tremors\r\n        </h1>\r\n\r\n        <div className=\"relative group\">\r\n          <Search size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-apple-subtext group-focus-within:text-apple-text transition-colors\" />\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search Library\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n            className=\"w-full bg-gray-200 dark:bg-white/10 rounded-lg pl-9 pr-3 py-2 text-sm text-apple-text outline-none focus:ring-2 focus:ring-apple-accent/50 transition-all placeholder:text-apple-subtext\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <nav className=\"space-y-1 flex-shrink-0\">\r\n        <NavLink to=\"/\" className={({ isActive }) => cn(\"w-full text-left px-3 py-2 rounded-md font-medium flex items-center gap-3 transition\", isActive ? \"bg-gray-200 dark:bg-white/10 text-apple-text\" : \"text-apple-subtext hover:text-apple-text hover:bg-white/5\")}>\r\n          <Music size={18} /> Songs\r\n        </NavLink>\r\n        <NavLink to=\"/albums\" className={({ isActive }) => cn(\"w-full text-left px-3 py-2 rounded-md font-medium flex items-center gap-3 transition\", isActive ? \"bg-gray-200 dark:bg-white/10 text-apple-text\" : \"text-apple-subtext hover:text-apple-text hover:bg-white/5\")}>\r\n          <Disc size={18} /> Albums\r\n        </NavLink>\r\n        <NavLink to=\"/artists\" className={({ isActive }) => cn(\"w-full text-left px-3 py-2 rounded-md font-medium flex items-center gap-3 transition\", isActive ? \"bg-gray-200 dark:bg-white/10 text-apple-text\" : \"text-apple-subtext hover:text-apple-text hover:bg-white/5\")}>\r\n          <Mic2 size={18} /> Artists\r\n        </NavLink>\r\n      </nav>\r\n\r\n      <div className=\"mt-8 mb-2 px-3 flex items-center justify-between group flex-shrink-0\">\r\n        <NavLink to=\"/playlists\" className={({ isActive }) => cn(\"text-xs font-bold uppercase tracking-wider flex-1 transition\", isActive ? \"text-apple-accent\" : \"text-apple-subtext hover:text-apple-text\")}>\r\n          Playlists\r\n        </NavLink>\r\n        <button\r\n          onClick={() => setIsCreatingPlaylist(true)}\r\n          className=\"hover:text-apple-accent text-apple-subtext transition p-1 rounded hover:bg-black/5 dark:hover:bg-white/10\"\r\n          title=\"Create Playlist\"\r\n        >\r\n          <PlusCircle size={16} />\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"space-y-1 overflow-y-auto flex-1 min-h-0 no-scrollbar -mx-2 px-2\">\r\n        {playlists?.map(pl => (\r\n          <NavLink\r\n            key={pl.id}\r\n            to={`/playlists/${pl.id}`}\r\n            className={({ isActive }) => cn(\r\n              \"w-full text-left px-3 py-2 rounded-md font-medium flex items-center gap-3 transition truncate text-sm\",\r\n              isActive ? \"bg-gray-200 dark:bg-white/10 text-apple-text\" : \"text-apple-subtext hover:text-apple-text hover:bg-white/5\"\r\n            )}\r\n          >\r\n            <ListMusic size={16} className=\"flex-shrink-0\" />\r\n            <span className=\"truncate\">{pl.name}</span>\r\n          </NavLink>\r\n        ))}\r\n        {(!playlists || playlists.length === 0) && (\r\n          <div className=\"px-3 py-4 text-xs text-apple-subtext text-center italic\">\r\n            No playlists yet\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-white/5 flex-shrink-0\">\r\n        <NavLink to=\"/settings\" className={({ isActive }) => cn(\"flex items-center gap-2 text-sm font-medium transition p-3 rounded-lg w-full\", isActive ? \"bg-apple-accent/10 text-apple-accent\" : \"text-apple-subtext hover:text-apple-text hover:bg-black/5 dark:hover:bg-white/5\")}>\r\n          <Settings size={18} /> Settings\r\n        </NavLink>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction AppContent() {\r\n  const location = useLocation();\r\n  const [isCreatingPlaylist, setIsCreatingPlaylist] = useState(false);\r\n\r\n  useKeyboardShortcuts({\r\n    onFocusSearch: () => {\r\n      const searchInput = document.querySelector('input[placeholder=\"Search Library\"]') as HTMLInputElement;\r\n      searchInput?.focus();\r\n    }\r\n  });\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col bg-apple-gray transition-colors duration-300 text-apple-text font-sans selection:bg-apple-accent/30\">\r\n      <Sidebar setIsCreatingPlaylist={setIsCreatingPlaylist} />\r\n\r\n      <div className=\"lg:ml-64 flex-1 flex flex-col h-screen pb-24 relative z-0 overflow-hidden\">\r\n        <AnimatePresence mode=\"wait\">\r\n          <Routes location={location} key={location.pathname}>\r\n            <Route path=\"/\" element={<LibraryPage />} />\r\n            <Route path=\"/search\" element={<SearchPage />} />\r\n            <Route path=\"/albums\" element={<AlbumsPage />} />\r\n            <Route path=\"/albums/:id\" element={<AlbumDetail />} />\r\n            <Route path=\"/artists\" element={<ArtistsPage />} />\r\n            <Route path=\"/playlists\" element={<AllPlaylistsPage />} />\r\n            <Route path=\"/playlists/:id\" element={<PlaylistDetail />} />\r\n            <Route path=\"/settings\" element={<SettingsPage />} />\r\n            <Route path=\"/artists/:name\" element={<ArtistDetail />} />\r\n          </Routes>\r\n        </AnimatePresence>\r\n      </div>\r\n\r\n      <Player />\r\n      <ToastContainer />\r\n      <ConfirmDialog />\r\n      {isCreatingPlaylist && <CreatePlaylistModal onClose={() => setIsCreatingPlaylist(false)} />}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function App() {\r\n  return (\r\n    <ErrorBoundary>\r\n      <BrowserRouter>\r\n        <AppContent />\r\n      </BrowserRouter>\r\n    </ErrorBoundary>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\AddToPlaylistModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":28,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":38,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":15}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { getPlaylists, createPlaylist, addToPlaylist } from '../lib/api';\r\nimport { useToastStore } from '../stores/toastStore';\r\nimport { X, Plus, Check, ListMusic } from 'lucide-react';\r\n\r\ninterface Props {\r\n  songIds: number[];\r\n  onClose: () => void;\r\n}\r\n\r\nexport function AddToPlaylistModal({ songIds, onClose }: Props) {\r\n  const queryClient = useQueryClient();\r\n  const { addToast } = useToastStore();\r\n  const [newPlaylistName, setNewPlaylistName] = useState('');\r\n  const [isCreating, setIsCreating] = useState(false);\r\n\r\n  const { data: playlists } = useQuery({ queryKey: ['playlists'], queryFn: getPlaylists });\r\n\r\n  const handleCreate = async () => {\r\n    if (!newPlaylistName) return;\r\n    try {\r\n      const pl = await createPlaylist(newPlaylistName);\r\n      await addToPlaylist(pl.id, songIds);\r\n      queryClient.invalidateQueries({ queryKey: ['playlists'] });\r\n      addToast(`Created \"${pl.name}\" and added songs`); // <--- Toast\r\n      onClose();\r\n    } catch (e) {\r\n      addToast('Failed to create playlist', 'error');\r\n    }\r\n  };\r\n\r\n  const handleAdd = async (playlistId: number) => {\r\n    try {\r\n      await addToPlaylist(playlistId, songIds);\r\n      addToast('Songs added to playlist'); // <--- Toast\r\n      onClose();\r\n    } catch (e) {\r\n      addToast('Failed to add songs', 'error');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[200] bg-black/20 flex items-center justify-center backdrop-blur-sm\">\r\n      <div className=\"bg-white dark:bg-[#1c1c1e] p-6 rounded-2xl w-full max-w-sm shadow-2xl border border-white/10 animate-in zoom-in-95 duration-200\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h3 className=\"font-bold text-apple-text\">Add to Playlist</h3>\r\n          <button onClick={onClose}><X size={20} className=\"text-apple-subtext hover:text-apple-text\" /></button>\r\n        </div>\r\n\r\n        <div className=\"max-h-60 overflow-y-auto space-y-1 mb-4 no-scrollbar\">\r\n          {playlists?.map(pl => (\r\n            <button \r\n              key={pl.id}\r\n              onClick={() => handleAdd(pl.id)}\r\n              className=\"w-full text-left p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 text-apple-text flex items-center gap-3 transition\"\r\n            >\r\n              <span className=\"w-8 h-8 bg-gray-100 dark:bg-white/10 rounded-md flex items-center justify-center text-apple-accent\">\r\n                 <ListMusic size={16} />\r\n              </span>\r\n              <span className=\"truncate font-medium text-sm\">{pl.name}</span>\r\n            </button>\r\n          ))}\r\n          {playlists?.length === 0 && <p className=\"text-center text-apple-subtext py-4 text-sm\">No playlists yet.</p>}\r\n        </div>\r\n\r\n        <div className=\"pt-4 border-t border-gray-200 dark:border-white/10\">\r\n           {!isCreating ? (\r\n             <button \r\n               onClick={() => setIsCreating(true)}\r\n               className=\"w-full py-2.5 bg-apple-accent/10 text-apple-accent rounded-lg font-medium hover:bg-apple-accent/20 transition flex items-center justify-center gap-2 text-sm\"\r\n             >\r\n               <Plus size={16} /> New Playlist\r\n             </button>\r\n           ) : (\r\n             <div className=\"flex gap-2\">\r\n               <input \r\n                 autoFocus\r\n                 className=\"flex-1 bg-gray-100 dark:bg-white/10 rounded-lg px-3 py-2 outline-none text-apple-text text-sm focus:ring-1 focus:ring-apple-accent\"\r\n                 placeholder=\"Playlist Name...\"\r\n                 value={newPlaylistName}\r\n                 onChange={e => setNewPlaylistName(e.target.value)}\r\n                 onKeyDown={e => e.key === 'Enter' && handleCreate()}\r\n               />\r\n               <button onClick={handleCreate} className=\"p-2 bg-apple-accent text-white rounded-lg hover:opacity-90\">\r\n                 <Check size={18} />\r\n               </button>\r\n             </div>\r\n           )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\ConfirmDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\ContextMenu.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[330,333],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[330,333],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { MoreHorizontal, ListPlus, Disc, User, Play } from 'lucide-react';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { useToastStore } from '../stores/toastStore';\r\n\r\ninterface SongMenuProps {\r\n    song: any;\r\n    onAddToPlaylist: () => void;\r\n    position?: 'left' | 'right';\r\n}\r\n\r\nexport function SongContextMenu({ song, onAddToPlaylist, position = 'right' }: SongMenuProps) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const menuRef = useRef<HTMLDivElement>(null);\r\n    const navigate = useNavigate();\r\n    const { addToQueue } = usePlayerStore();\r\n    const { addToast } = useToastStore();\r\n\r\n    // Close menu when clicking outside\r\n    useEffect(() => {\r\n        const handleClickOutside = (e: MouseEvent) => {\r\n            if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\r\n                setIsOpen(false);\r\n            }\r\n        };\r\n        if (isOpen) {\r\n            document.addEventListener('mousedown', handleClickOutside);\r\n            return () => document.removeEventListener('mousedown', handleClickOutside);\r\n        }\r\n    }, [isOpen]);\r\n\r\n    const handleAddToQueue = () => {\r\n        addToQueue(song);\r\n        addToast('Added to queue');\r\n        setIsOpen(false);\r\n    };\r\n\r\n    const handleGoToAlbum = () => {\r\n        if (song.album_id) {\r\n            navigate(`/albums/${song.album_id}`);\r\n        }\r\n        setIsOpen(false);\r\n    };\r\n\r\n    const handleGoToArtist = () => {\r\n        if (song.artist) {\r\n            navigate(`/artists/${encodeURIComponent(song.artist)}`);\r\n        }\r\n        setIsOpen(false);\r\n    };\r\n\r\n    const handleAddToPlaylist = () => {\r\n        onAddToPlaylist();\r\n        setIsOpen(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative\" ref={menuRef}>\r\n            <button\r\n                onClick={(e) => { e.stopPropagation(); setIsOpen(!isOpen); }}\r\n                className=\"p-1.5 text-apple-subtext opacity-0 group-hover/row:opacity-100 transition rounded hover:bg-gray-300 dark:hover:bg-white/10\"\r\n            >\r\n                <MoreHorizontal size={16} />\r\n            </button>\r\n\r\n            {isOpen && (\r\n                <div\r\n                    className={`absolute ${position === 'left' ? 'right-0' : 'left-0'} top-8 w-48 bg-white dark:bg-[#2c2c2e] rounded-xl shadow-2xl border border-gray-200 dark:border-white/10 py-1.5 z-50 animate-in fade-in zoom-in-95 duration-100`}\r\n                    onClick={(e) => e.stopPropagation()}\r\n                >\r\n                    <MenuItem icon={<Play size={14} />} label=\"Play Next\" onClick={handleAddToQueue} />\r\n                    <MenuItem icon={<ListPlus size={14} />} label=\"Add to Playlist\" onClick={handleAddToPlaylist} />\r\n\r\n                    <div className=\"h-px bg-gray-100 dark:bg-white/10 my-1.5\" />\r\n\r\n                    {song.album_id && (\r\n                        <MenuItem icon={<Disc size={14} />} label=\"Go to Album\" onClick={handleGoToAlbum} />\r\n                    )}\r\n                    {song.artist && (\r\n                        <MenuItem icon={<User size={14} />} label=\"Go to Artist\" onClick={handleGoToArtist} />\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction MenuItem({ icon, label, onClick }: { icon: React.ReactNode; label: string; onClick: () => void }) {\r\n    return (\r\n        <button\r\n            onClick={onClick}\r\n            className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n        >\r\n            <span className=\"text-apple-subtext\">{icon}</span>\r\n            {label}\r\n        </button>\r\n    );\r\n}\r\n\r\n// Clickable link components for artist/album names\r\ninterface ClickableLinkProps {\r\n    children: React.ReactNode;\r\n    onClick: (e: React.MouseEvent) => void;\r\n    className?: string;\r\n}\r\n\r\nexport function ClickableLink({ children, onClick, className = '' }: ClickableLinkProps) {\r\n    return (\r\n        <span\r\n            onClick={(e) => {\r\n                e.stopPropagation();\r\n                onClick(e);\r\n            }}\r\n            className={`hover:text-apple-accent hover:underline cursor-pointer transition ${className}`}\r\n        >\r\n            {children}\r\n        </span>\r\n    );\r\n}\r\n\r\nexport function ArtistLink({ name, className = '' }: { name: string; className?: string }) {\r\n    const navigate = useNavigate();\r\n\r\n    if (!name) return null;\r\n\r\n    return (\r\n        <ClickableLink\r\n            onClick={() => navigate(`/artists/${encodeURIComponent(name)}`)}\r\n            className={className}\r\n        >\r\n            {name}\r\n        </ClickableLink>\r\n    );\r\n}\r\n\r\nexport function AlbumLink({ id, title, className = '' }: { id: number; title: string; className?: string }) {\r\n    const navigate = useNavigate();\r\n\r\n    if (!id || !title) return null;\r\n\r\n    return (\r\n        <ClickableLink\r\n            onClick={() => navigate(`/albums/${id}`)}\r\n            className={className}\r\n        >\r\n            {title}\r\n        </ClickableLink>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\CreatePlaylistModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":27,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useQueryClient } from '@tanstack/react-query';\r\nimport { createPlaylist } from '../lib/api';\r\nimport { useToastStore } from '../stores/toastStore';\r\nimport { X, ListMusic } from 'lucide-react';\r\n\r\ninterface Props {\r\n  onClose: () => void;\r\n}\r\n\r\nexport function CreatePlaylistModal({ onClose }: Props) {\r\n  const [name, setName] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const queryClient = useQueryClient();\r\n  const { addToast } = useToastStore();\r\n\r\n  const handleSubmit = async (e?: React.FormEvent) => {\r\n    e?.preventDefault();\r\n    if (!name.trim()) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      await createPlaylist(name);\r\n      queryClient.invalidateQueries({ queryKey: ['playlists'] });\r\n      addToast(`Created playlist \"${name}\"`);\r\n      onClose();\r\n    } catch (error) {\r\n      addToast('Failed to create playlist', 'error');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[200] bg-black/20 backdrop-blur-sm flex items-center justify-center\">\r\n      <div className=\"bg-white dark:bg-[#1c1c1e] w-full max-w-sm p-6 rounded-2xl shadow-2xl border border-white/10 animate-in zoom-in-95 duration-200\">\r\n        \r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n          <h3 className=\"font-bold text-lg text-apple-text\">New Playlist</h3>\r\n          <button onClick={onClose} className=\"text-apple-subtext hover:text-apple-text transition\">\r\n            <X size={20} />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Icon Preview */}\r\n        <div className=\"flex justify-center mb-6\">\r\n          <div className=\"w-24 h-24 bg-gray-100 dark:bg-white/5 rounded-xl flex items-center justify-center shadow-inner\">\r\n            <ListMusic size={40} className=\"text-apple-accent opacity-80\" />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Form */}\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          <div>\r\n            <input \r\n              autoFocus\r\n              type=\"text\" \r\n              placeholder=\"Playlist Name\" \r\n              value={name}\r\n              onChange={(e) => setName(e.target.value)}\r\n              className=\"w-full bg-gray-100 dark:bg-white/5 border border-transparent focus:border-apple-accent/50 rounded-lg px-4 py-3 text-apple-text outline-none transition-all placeholder:text-apple-subtext\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex gap-3 pt-2\">\r\n            <button \r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"flex-1 py-3 rounded-lg font-medium text-apple-text hover:bg-gray-100 dark:hover:bg-white/5 transition\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button \r\n              type=\"submit\"\r\n              disabled={!name.trim() || isLoading}\r\n              className=\"flex-1 py-3 bg-apple-accent text-white rounded-lg font-medium hover:opacity-90 transition disabled:opacity-50 flex items-center justify-center gap-2\"\r\n            >\r\n              {isLoading ? 'Creating...' : 'Create'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\FullScreenPlayer.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\FullScreenPlayer.tsx:30:7\n  28 |     if (currentSong && currentSong.id !== lastSongIdRef.current) {\n  29 |       lastSongIdRef.current = currentSong.id;\n> 30 |       setLyrics(null);\n     |       ^^^^^^^^^ Avoid calling setState() directly within an effect\n  31 |       getLyrics(currentSong.id).then(setLyrics).catch(() => setLyrics(null));\n  32 |     }\n  33 |   }, [currentSong?.id]);","line":30,"column":7,"nodeType":null,"endLine":30,"endColumn":16},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'currentSong'. Either include it or remove the dependency array.","line":33,"column":6,"nodeType":"ArrayExpression","endLine":33,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [currentSong, currentSong.id]","fix":{"range":[1436,1453],"text":"[currentSong, currentSong.id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1498,1501],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1498,1501],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1899,1902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1899,1902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useRef } from 'react';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { getCoverUrl, getLyrics } from '../lib/api';\r\nimport { cn, formatTime } from '../lib/utils';\r\nimport { ChevronDown, Play, Pause, SkipBack, SkipForward, MessageSquare, Volume2, Repeat, Shuffle, Repeat1 } from 'lucide-react';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport { SyncedLyrics } from './player/SyncedLyrics';\r\n\r\ninterface FullScreenPlayerProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function FullScreenPlayer({ isOpen, onClose }: FullScreenPlayerProps) {\r\n  const {\r\n    currentSong, isPlaying, togglePlay, playNext, playPrev,\r\n    volume, setVolume, repeatMode, toggleRepeat, isShuffle, toggleShuffle\r\n  } = usePlayerStore();\r\n\r\n  const [lyrics, setLyrics] = useState<{ plainLyrics?: string, syncedLyrics?: string } | null>(null);\r\n  const [showLyrics, setShowLyrics] = useState(false);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [duration, setDuration] = useState(0);\r\n  const lastSongIdRef = useRef<number | null>(null);\r\n\r\n  // Only fetch lyrics when song changes, not when fullscreen toggles\r\n  useEffect(() => {\r\n    if (currentSong && currentSong.id !== lastSongIdRef.current) {\r\n      lastSongIdRef.current = currentSong.id;\r\n      setLyrics(null);\r\n      getLyrics(currentSong.id).then(setLyrics).catch(() => setLyrics(null));\r\n    }\r\n  }, [currentSong?.id]);\r\n\r\n  useEffect(() => {\r\n    let interval: any;\r\n    if (isOpen) {\r\n      interval = setInterval(() => {\r\n        const audio = document.querySelector('audio');\r\n        if (audio) {\r\n          setCurrentTime(audio.currentTime);\r\n          setDuration(audio.duration || 0);\r\n        }\r\n      }, 100); // Increased frequency for smoother lyrics sync\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [isOpen]);\r\n\r\n  const handleSeek = (e: any) => {\r\n    const val = Number(e.target.value);\r\n    const audio = document.querySelector('audio');\r\n    if (audio) {\r\n      audio.currentTime = val;\r\n      setCurrentTime(val);\r\n    }\r\n  };\r\n\r\n  if (!currentSong) return null;\r\n\r\n  const lyricsContent = lyrics?.syncedLyrics || lyrics?.plainLyrics;\r\n  const hasSyncedLyrics = !!lyrics?.syncedLyrics;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <motion.div\r\n          initial={{ y: '100%' }}\r\n          animate={{ y: 0 }}\r\n          exit={{ y: '100%' }}\r\n          transition={{ type: 'spring', damping: 25, stiffness: 200 }}\r\n          className=\"fixed inset-0 z-[100] bg-[#1c1c1e] text-white flex flex-col overflow-hidden\"\r\n        >\r\n          {/* --- Background --- */}\r\n          <div className=\"absolute inset-0 bg-cover bg-center opacity-30 blur-[100px] scale-125 pointer-events-none transform-gpu\"\r\n            style={{ backgroundImage: `url(${getCoverUrl(currentSong.album_id!)})` }}\r\n          />\r\n          <div className=\"absolute inset-0 bg-black/40\" />\r\n\r\n          {/* --- Header --- */}\r\n          <div className=\"relative z-20 flex justify-between items-center px-8 py-6 flex-shrink-0\">\r\n            <button onClick={onClose} className=\"p-2 bg-white/10 rounded-full hover:bg-white/20\"><ChevronDown size={20} /></button>\r\n            <div className=\"w-10\" />\r\n          </div>\r\n\r\n          {/* --- Main Content --- */}\r\n          <div className=\"relative z-10 flex-1 min-h-0 w-full max-w-screen-2xl mx-auto px-8 pb-8 flex gap-12 items-center\">\r\n\r\n            {/* LEFT COLUMN: Art & Controls */}\r\n            <div className={cn(\r\n              \"flex flex-col justify-center h-full transition-all duration-500 ease-in-out mx-auto\",\r\n              showLyrics ? \"w-1/2 max-w-xl\" : \"w-full max-w-lg\"\r\n            )}>\r\n\r\n              {/* Flexible Art Container */}\r\n              <div className=\"flex-1 min-h-0 flex items-center justify-center mb-6 w-full\">\r\n                <div className=\"aspect-square h-full max-h-[50vh] w-auto rounded-xl shadow-2xl overflow-hidden border border-white/10 bg-gray-800 relative flex-shrink-0\">\r\n                  <img src={getCoverUrl(currentSong.album_id!)} className=\"w-full h-full object-cover\" />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Metadata & Controls */}\r\n              <div className=\"flex-shrink-0 space-y-6 w-full\">\r\n                <div className={showLyrics ? \"text-left\" : \"text-center\"}>\r\n                  <h2 className=\"text-2xl font-bold truncate leading-tight\">{currentSong.title}</h2>\r\n                  <p className=\"text-lg text-white/60 truncate mt-1\">{currentSong.artist}</p>\r\n\r\n                  {/* TECH BADGES */}\r\n                  <div className={cn(\"flex gap-2 mt-3 opacity-60\", showLyrics ? \"justify-start\" : \"justify-center\")}>\r\n                    <span className=\"px-1.5 py-0.5 rounded border border-white/30 text-[9px] font-bold uppercase tracking-widest text-white/80\">\r\n                      {currentSong.format?.toUpperCase() || 'MP3'}\r\n                    </span>\r\n                    {currentSong.bitrate && (\r\n                      <span className=\"px-1.5 py-0.5 rounded border border-white/30 text-[9px] font-bold uppercase tracking-widest text-white/80\">\r\n                        {currentSong.bitrate} kbps\r\n                      </span>\r\n                    )}\r\n                    {currentSong.sample_rate && (\r\n                      <span className=\"px-1.5 py-0.5 rounded border border-white/30 text-[9px] font-bold uppercase tracking-widest text-white/80\">\r\n                        {(currentSong.sample_rate / 1000).toFixed(1)} kHz\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Progress */}\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"relative w-full h-1 bg-white/20 rounded-full group cursor-pointer\">\r\n                    <div\r\n                      className=\"absolute top-0 left-0 h-full bg-white rounded-full\"\r\n                      style={{ width: `${(currentTime / duration) * 100}%` }}\r\n                    />\r\n                    <input\r\n                      type=\"range\" min={0} max={duration || 100} value={currentTime}\r\n                      onChange={handleSeek}\r\n                      className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex justify-between text-xs font-medium text-white/50\">\r\n                    <span>{formatTime(currentTime)}</span>\r\n                    <span>{formatTime(duration)}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Controls */}\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-2 w-24\">\r\n                    <Volume2 size={16} className=\"text-white/60\" />\r\n                    <input\r\n                      type=\"range\" min={0} max={1} step={0.01} value={volume}\r\n                      onChange={e => setVolume(parseFloat(e.target.value))}\r\n                      className=\"w-16 h-1 bg-white/20 rounded-lg appearance-none cursor-pointer accent-white\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center gap-8\">\r\n                    <button onClick={playPrev} className=\"hover:text-white/80 transition hover:scale-105\"><SkipBack size={28} fill=\"currentColor\" /></button>\r\n                    <button onClick={togglePlay} className=\"hover:scale-105 transition\">\r\n                      {isPlaying ? <Pause size={48} fill=\"currentColor\" /> : <Play size={48} fill=\"currentColor\" />}\r\n                    </button>\r\n                    <button onClick={playNext} className=\"hover:text-white/80 transition hover:scale-105\"><SkipForward size={28} fill=\"currentColor\" /></button>\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center gap-3 w-24 justify-end\">\r\n                    <button onClick={toggleShuffle} className={cn(\"transition\", isShuffle ? \"text-apple-accent\" : \"text-white/40 hover:text-white\")}>\r\n                      <Shuffle size={18} />\r\n                    </button>\r\n                    <button onClick={toggleRepeat} className={cn(\"transition relative\", repeatMode !== 'off' ? \"text-apple-accent\" : \"text-white/40 hover:text-white\")}>\r\n                      {repeatMode === 'one' ? <Repeat1 size={18} /> : <Repeat size={18} />}\r\n                      {repeatMode !== 'off' && <div className=\"absolute -bottom-2 left-1/2 -translate-x-1/2 w-0.5 h-0.5 bg-current rounded-full\" />}\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setShowLyrics(!showLyrics)}\r\n                      className={cn(\"transition p-1.5 rounded-md\", showLyrics ? \"bg-white/20 text-white\" : \"text-white/40 hover:text-white\")}\r\n                    >\r\n                      <MessageSquare size={18} fill={showLyrics ? \"currentColor\" : \"none\"} />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* RIGHT COLUMN: Lyrics */}\r\n            {showLyrics && (\r\n              <div className=\"hidden md:flex flex-col w-1/2 h-full animate-in fade-in slide-in-from-right-10 duration-300\">\r\n                <div className=\"flex items-center justify-between mb-6 flex-shrink-0\">\r\n                  <h3 className=\"text-xs font-bold text-white/40 uppercase tracking-widest\">Lyrics</h3>\r\n                  {hasSyncedLyrics && (\r\n                    <span className=\"text-xs text-apple-accent font-semibold uppercase tracking-wider\">Synced</span>\r\n                  )}\r\n                </div>\r\n                <div className=\"flex-1 overflow-hidden\">\r\n                  {lyricsContent ? (\r\n                    hasSyncedLyrics ? (\r\n                      <SyncedLyrics\r\n                        lyrics={lyricsContent}\r\n                        currentTime={currentTime}\r\n                        className=\"h-full\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"h-full overflow-y-auto no-scrollbar\">\r\n                        <div className=\"whitespace-pre-wrap text-2xl font-bold text-white/80 leading-relaxed space-y-8 pb-20\">\r\n                          {lyricsContent}\r\n                        </div>\r\n                      </div>\r\n                    )\r\n                  ) : (\r\n                    <div className=\"flex items-center justify-center h-full text-white/30 italic text-xl font-medium\">\r\n                      Searching for lyrics...\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\PageWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\Player.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'setIsPlaying'. Either include it or remove the dependency array.","line":36,"column":6,"nodeType":"ArrayExpression","endLine":36,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [isPlaying, currentSong, setIsPlaying]","fix":{"range":[1541,1565],"text":"[isPlaying, currentSong, setIsPlaying]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useState } from 'react';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { getStreamUrl, getCoverUrl } from '../lib/api';\r\nimport { formatTime, cn } from '../lib/utils';\r\nimport { Play, Pause, SkipBack, SkipForward, Volume2, VolumeX, Disc, ChevronUp, Shuffle, Repeat, Repeat1, ListMusic } from 'lucide-react';\r\nimport { FullScreenPlayer } from './FullScreenPlayer';\r\nimport { QueuePanel } from './player/QueuePanel';\r\nimport { useKeyboardShortcuts } from '../hooks/useKeyboardShortcuts';\r\nimport { ArtistLink } from './ContextMenu';\r\n\r\nexport function Player() {\r\n  const {\r\n    currentSong, isPlaying, volume, togglePlay, playNext, playPrev,\r\n    setVolume, setIsPlaying, repeatMode, toggleRepeat, isShuffle, toggleShuffle\r\n  } = usePlayerStore();\r\n\r\n  const audioRef = useRef<HTMLAudioElement>(null);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [duration, setDuration] = useState(0);\r\n  const [isFullScreen, setIsFullScreen] = useState(false);\r\n  const [isQueueOpen, setIsQueueOpen] = useState(false);\r\n  const [previousVolume, setPreviousVolume] = useState(1);\r\n\r\n  // Keyboard shortcuts for player-specific actions\r\n  useKeyboardShortcuts({\r\n    onToggleFullscreen: () => setIsFullScreen(prev => !prev),\r\n    onToggleQueue: () => setIsQueueOpen(prev => !prev),\r\n  });\r\n\r\n  // Sync Play/Pause\r\n  useEffect(() => {\r\n    if (audioRef.current) {\r\n      if (isPlaying) audioRef.current.play().catch(() => setIsPlaying(false));\r\n      else audioRef.current.pause();\r\n    }\r\n  }, [isPlaying, currentSong]);\r\n\r\n  // Sync Volume\r\n  useEffect(() => {\r\n    if (audioRef.current) audioRef.current.volume = volume;\r\n  }, [volume]);\r\n\r\n  const handleTimeUpdate = () => {\r\n    if (audioRef.current) {\r\n      setCurrentTime(audioRef.current.currentTime);\r\n      setDuration(audioRef.current.duration || 0);\r\n    }\r\n  };\r\n\r\n  const handleSeek = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const time = Number(e.target.value);\r\n    if (audioRef.current) {\r\n      audioRef.current.currentTime = time;\r\n      setCurrentTime(time);\r\n    }\r\n  };\r\n\r\n  const handleMuteToggle = () => {\r\n    if (volume > 0) {\r\n      setPreviousVolume(volume);\r\n      setVolume(0);\r\n    } else {\r\n      setVolume(previousVolume || 1);\r\n    }\r\n  };\r\n\r\n  if (!currentSong) return null;\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className=\"fixed bottom-0 left-0 right-0 h-24 glass z-40 px-4 md:px-8 flex items-center justify-between transition-all border-t border-gray-200 dark:border-white/10\"\r\n        onClick={(e) => {\r\n          if ((e.target as HTMLElement).tagName !== 'BUTTON' && (e.target as HTMLElement).tagName !== 'INPUT') {\r\n            setIsFullScreen(true);\r\n          }\r\n        }}\r\n      >\r\n        {/* Audio Engine */}\r\n        <audio\r\n          ref={audioRef}\r\n          src={getStreamUrl(currentSong.id)}\r\n          loop={repeatMode === 'one'}\r\n          onTimeUpdate={handleTimeUpdate}\r\n          onEnded={() => {\r\n            if (repeatMode !== 'one') playNext();\r\n          }}\r\n          onLoadedMetadata={(e) => setDuration(e.currentTarget.duration)}\r\n        />\r\n\r\n        {/* LEFT: Art & Text */}\r\n        <div className=\"flex items-center gap-4 w-1/3 min-w-0 cursor-pointer group\">\r\n          <div className=\"w-14 h-14 rounded-md shadow-lg overflow-hidden flex-shrink-0 border border-white/10 bg-gray-800 relative\">\r\n            {currentSong.album_id ? (\r\n              <img src={getCoverUrl(currentSong.album_id)} alt=\"art\" className=\"w-full h-full object-cover\" />\r\n            ) : <Disc className=\"m-auto text-gray-500\" />}\r\n            <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition\">\r\n              <ChevronUp size={20} className=\"text-white\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"truncate hidden sm:block\">\r\n            <h3 className=\"font-semibold text-apple-text truncate text-sm\">{currentSong.title}</h3>\r\n            <p className=\"text-xs text-apple-subtext truncate\">\r\n              <ArtistLink name={currentSong.artist} />\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* CENTER: Controls & Progress */}\r\n        <div className=\"flex flex-col items-center w-1/3 max-w-lg gap-1\">\r\n          <div className=\"flex items-center gap-6\">\r\n            {/* Shuffle */}\r\n            <button\r\n              onClick={(e) => { e.stopPropagation(); toggleShuffle(); }}\r\n              className={cn(\"transition hover:scale-110 hidden sm:block\", isShuffle ? \"text-apple-accent\" : \"text-apple-subtext hover:text-apple-text\")}\r\n              title=\"Shuffle\"\r\n            >\r\n              <Shuffle size={18} />\r\n            </button>\r\n\r\n            <button onClick={(e) => { e.stopPropagation(); playPrev(); }} className=\"text-apple-text hover:text-apple-accent transition\" title=\"Previous (ΓåÉ)\">\r\n              <SkipBack size={24} />\r\n            </button>\r\n\r\n            <button onClick={(e) => { e.stopPropagation(); togglePlay(); }} className=\"w-10 h-10 bg-apple-text text-white rounded-full flex items-center justify-center hover:scale-105 shadow-md transition-transform\" title=\"Play/Pause (Space)\">\r\n              {isPlaying ? <Pause size={20} fill=\"currentColor\" /> : <Play size={20} fill=\"currentColor\" className=\"ml-1\" />}\r\n            </button>\r\n\r\n            <button onClick={(e) => { e.stopPropagation(); playNext(); }} className=\"text-apple-text hover:text-apple-accent transition\" title=\"Next (ΓåÆ)\">\r\n              <SkipForward size={24} />\r\n            </button>\r\n\r\n            {/* Repeat */}\r\n            <button\r\n              onClick={(e) => { e.stopPropagation(); toggleRepeat(); }}\r\n              className={cn(\"transition hover:scale-110 hidden sm:block relative\", repeatMode !== 'off' ? \"text-apple-accent\" : \"text-apple-subtext hover:text-apple-text\")}\r\n              title={repeatMode === 'off' ? 'Repeat Off' : repeatMode === 'one' ? 'Repeat One' : 'Repeat All'}\r\n            >\r\n              {repeatMode === 'one' ? <Repeat1 size={18} /> : <Repeat size={18} />}\r\n              {repeatMode !== 'off' && <div className=\"absolute -bottom-2 left-1/2 -translate-x-1/2 w-1 h-1 bg-current rounded-full\" />}\r\n            </button>\r\n          </div>\r\n\r\n          {/* Progress Bar */}\r\n          <div className=\"w-full flex items-center gap-3 text-[10px] text-apple-subtext font-medium\">\r\n            <span className=\"min-w-[30px] text-right\">{formatTime(currentTime)}</span>\r\n            <div className=\"flex-1 h-1 bg-gray-300 dark:bg-white/10 rounded-full relative group\">\r\n              <div\r\n                className=\"absolute top-0 left-0 h-full bg-apple-text rounded-full transition-all\"\r\n                style={{ width: `${(currentTime / duration) * 100}%` }}\r\n              />\r\n              <input\r\n                type=\"range\" min={0} max={duration || 100} value={currentTime}\r\n                onClick={(e) => e.stopPropagation()}\r\n                onChange={handleSeek}\r\n                className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\r\n                title=\"Seek (Shift + ΓåÉ/ΓåÆ)\"\r\n              />\r\n            </div>\r\n            <span className=\"min-w-[30px]\">{formatTime(duration)}</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* RIGHT: Volume & Queue */}\r\n        <div className=\"flex items-center justify-end gap-3 w-1/3\">\r\n          <div className=\"hidden sm:flex items-center gap-2 w-32 group relative\">\r\n            <button\r\n              onClick={(e) => { e.stopPropagation(); handleMuteToggle(); }}\r\n              className=\"text-apple-subtext hover:text-apple-text transition\"\r\n              title={volume > 0 ? \"Mute (M)\" : \"Unmute (M)\"}\r\n            >\r\n              {volume === 0 ? <VolumeX size={16} /> : <Volume2 size={16} />}\r\n            </button>\r\n            <div className=\"relative flex-1\">\r\n              <input\r\n                type=\"range\" min={0} max={1} step={0.01} value={volume}\r\n                onClick={(e) => e.stopPropagation()}\r\n                onChange={(e) => setVolume(parseFloat(e.target.value))}\r\n                className=\"w-full h-1 bg-gray-300 dark:bg-white/20 rounded-lg appearance-none cursor-pointer accent-apple-text hover:accent-apple-accent transition\"\r\n                title=\"Volume (Γåæ/Γåô)\"\r\n              />\r\n              {/* Volume percentage tooltip */}\r\n              <div className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition pointer-events-none whitespace-nowrap z-50\">\r\n                {Math.round(volume * 100)}%\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <button\r\n            onClick={(e) => { e.stopPropagation(); setIsQueueOpen(true); }}\r\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-full transition text-apple-subtext hover:text-apple-text\"\r\n            title=\"View Queue (Q)\"\r\n          >\r\n            <ListMusic size={20} />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <FullScreenPlayer isOpen={isFullScreen} onClose={() => setIsFullScreen(false)} />\r\n      <QueuePanel isOpen={isQueueOpen} onClose={() => setIsQueueOpen(false)} />\r\n    </>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\SettingsModal.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadPaths` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SettingsModal.tsx:23:5\n  21 |\n  22 |   useEffect(() => {\n> 23 |     loadPaths();\n     |     ^^^^^^^^^ `loadPaths` accessed before it is declared\n  24 |   }, []);\n  25 |\n  26 |   const loadPaths = async () => {\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SettingsModal.tsx:26:3\n  24 |   }, []);\n  25 |\n> 26 |   const loadPaths = async () => {\n     |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 27 |     const res = await api.get<LibraryPath[]>('/library/paths');\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |     setPaths(res.data);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 29 |   };\n     | ^^^^^ `loadPaths` is declared here\n  30 |\n  31 |   const handleAddPath = async () => {\n  32 |     if (!newPath) return;","line":23,"column":5,"nodeType":null,"endLine":23,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":37,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":15}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { X, Plus, Trash2, RefreshCw, Moon, Sun } from 'lucide-react';\r\nimport api from '../lib/api';\r\nimport { useThemeStore } from '../stores/themeStore';\r\n\r\ninterface SettingsModalProps {\r\n  onClose: () => void;\r\n}\r\n\r\ninterface LibraryPath {\r\n  id: number;\r\n  path: string;\r\n}\r\n\r\nexport function SettingsModal({ onClose }: SettingsModalProps) {\r\n  const [paths, setPaths] = useState<LibraryPath[]>([]);\r\n  const [newPath, setNewPath] = useState('');\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  \r\n  const { theme, setTheme, accentColor, setAccentColor } = useThemeStore();\r\n\r\n  useEffect(() => {\r\n    loadPaths();\r\n  }, []);\r\n\r\n  const loadPaths = async () => {\r\n    const res = await api.get<LibraryPath[]>('/library/paths');\r\n    setPaths(res.data);\r\n  };\r\n\r\n  const handleAddPath = async () => {\r\n    if (!newPath) return;\r\n    try {\r\n      await api.post('/library/paths', { path: newPath });\r\n      setNewPath('');\r\n      loadPaths();\r\n    } catch (e) {\r\n      alert('Invalid path or server error');\r\n    }\r\n  };\r\n\r\n  const handleRemovePath = async (id: number) => {\r\n    await api.delete(`/library/paths/${id}`);\r\n    loadPaths();\r\n  };\r\n\r\n  const handleRescan = async () => {\r\n    setIsScanning(true);\r\n    await api.post('/library/scan');\r\n    setTimeout(() => setIsScanning(false), 2000);\r\n  };\r\n\r\n  // Colors for the picker (RGB values)\r\n  const colors = [\r\n    { name: 'Red', val: '250 45 72' },\r\n    { name: 'Blue', val: '0 122 255' },\r\n    { name: 'Purple', val: '175 82 222' },\r\n    { name: 'Orange', val: '255 149 0' },\r\n    { name: 'Teal', val: '48 176 199' },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm\">\r\n      <div className=\"glass-panel w-full max-w-md p-6 relative animate-in fade-in zoom-in duration-200\">\r\n        <button onClick={onClose} className=\"absolute top-4 right-4 text-apple-subtext hover:text-apple-text\">\r\n          <X size={20} />\r\n        </button>\r\n\r\n        <h2 className=\"text-xl font-bold mb-6 text-apple-text\">Settings</h2>\r\n\r\n        {/* --- Appearance Section --- */}\r\n        <div className=\"mb-8\">\r\n          <h3 className=\"text-sm font-semibold text-apple-subtext uppercase mb-3\">Appearance</h3>\r\n          \r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <span className=\"text-apple-text\">Theme</span>\r\n            <div className=\"bg-gray-200 dark:bg-gray-700 rounded-full p-1 flex gap-1\">\r\n              <button \r\n                onClick={() => setTheme('light')}\r\n                className={`p-2 rounded-full transition ${theme === 'light' ? 'bg-white shadow-sm' : 'text-gray-500'}`}\r\n              >\r\n                <Sun size={16} />\r\n              </button>\r\n              <button \r\n                onClick={() => setTheme('dark')}\r\n                className={`p-2 rounded-full transition ${theme === 'dark' ? 'bg-gray-600 text-white shadow-sm' : 'text-gray-500'}`}\r\n              >\r\n                <Moon size={16} />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex gap-3\">\r\n            {colors.map((c) => (\r\n              <button\r\n                key={c.name}\r\n                onClick={() => setAccentColor(c.val)}\r\n                className={`w-8 h-8 rounded-full border-2 transition ${accentColor === c.val ? 'border-gray-400 scale-110' : 'border-transparent'}`}\r\n                style={{ backgroundColor: `rgb(${c.val})` }}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* --- Library Section --- */}\r\n        <div>\r\n          <h3 className=\"text-sm font-semibold text-apple-subtext uppercase mb-3\">Library Paths</h3>\r\n          \r\n          <div className=\"space-y-2 mb-4 max-h-40 overflow-y-auto\">\r\n            {paths.map(p => (\r\n              <div key={p.id} className=\"flex items-center justify-between bg-gray-100 dark:bg-gray-800 p-3 rounded-lg\">\r\n                <span className=\"text-xs font-mono truncate max-w-[200px] text-apple-text\">{p.path}</span>\r\n                <button onClick={() => handleRemovePath(p.id)} className=\"text-red-500 hover:bg-red-100 p-1 rounded\">\r\n                  <Trash2 size={16} />\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 mb-6\">\r\n            <input \r\n              type=\"text\" \r\n              value={newPath}\r\n              onChange={(e) => setNewPath(e.target.value)}\r\n              placeholder=\"Paste folder path...\"\r\n              className=\"flex-1 p-2 text-sm rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 text-apple-text focus:outline-none focus:ring-2 focus:ring-apple-accent\"\r\n            />\r\n            <button onClick={handleAddPath} className=\"p-2 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300\">\r\n              <Plus size={20} className=\"text-apple-text\" />\r\n            </button>\r\n          </div>\r\n\r\n          <button \r\n            onClick={handleRescan}\r\n            disabled={isScanning}\r\n            className=\"w-full py-3 bg-apple-accent text-white rounded-lg font-medium flex items-center justify-center gap-2 hover:opacity-90 transition\"\r\n          >\r\n            <RefreshCw size={18} className={isScanning ? \"animate-spin\" : \"\"} />\r\n            {isScanning ? 'Scanning...' : 'Rescan Library'}\r\n          </button>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\Skeletons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1195,1198],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1195,1198],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:93:34\n  91 |                                 <div className=\"h-px bg-gray-100 dark:bg-white/5 my-2\" />\n  92 |                                 <div className=\"px-4 py-2 text-xs font-bold text-apple-subtext uppercase tracking-wider\">Sort By</div>\n> 93 |                                 <SortOption label=\"Title\" field=\"title\" />\n     |                                  ^^^^^^^^^^ This component is created during render\n  94 |                                 <SortOption label=\"Artist\" field=\"artist\" />\n  95 |                                 <SortOption label=\"Album\" field=\"album\" />\n  96 |                                 <SortOption label=\"Duration\" field=\"duration\" />\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:50:24\n  48 |     };\n  49 |\n> 50 |     const SortOption = ({ label, field }: { label: string, field: string }) => (\n     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 51 |         <button\n     | ^^^^^^^^^^^^^^^\n> 52 |             onClick={() => handleSort(field)}\n     | ^^^^^^^^^^^^^^^\n> 53 |             className={cn(\"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/5 flex justify-between items-center transition\", sortBy === field && \"text-apple-accent font-medium\")}\n     | ^^^^^^^^^^^^^^^\n> 54 |         >\n     | ^^^^^^^^^^^^^^^\n> 55 |             {label}\n     | ^^^^^^^^^^^^^^^\n> 56 |             {sortBy === field && (order === 'asc' ? <ArrowUp size={14} /> : <ArrowDown size={14} />)}\n     | ^^^^^^^^^^^^^^^\n> 57 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 58 |     );\n     | ^^^^^^ The component is created during render here\n  59 |\n  60 |     if (isLoading) return <div className=\"p-12 text-center text-apple-subtext\">Loading Library...</div>;\n  61 |","line":93,"column":34,"nodeType":null,"endLine":93,"endColumn":44},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:94:34\n  92 |                                 <div className=\"px-4 py-2 text-xs font-bold text-apple-subtext uppercase tracking-wider\">Sort By</div>\n  93 |                                 <SortOption label=\"Title\" field=\"title\" />\n> 94 |                                 <SortOption label=\"Artist\" field=\"artist\" />\n     |                                  ^^^^^^^^^^ This component is created during render\n  95 |                                 <SortOption label=\"Album\" field=\"album\" />\n  96 |                                 <SortOption label=\"Duration\" field=\"duration\" />\n  97 |                                 <SortOption label=\"Date Added\" field=\"id\" />\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:50:24\n  48 |     };\n  49 |\n> 50 |     const SortOption = ({ label, field }: { label: string, field: string }) => (\n     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 51 |         <button\n     | ^^^^^^^^^^^^^^^\n> 52 |             onClick={() => handleSort(field)}\n     | ^^^^^^^^^^^^^^^\n> 53 |             className={cn(\"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/5 flex justify-between items-center transition\", sortBy === field && \"text-apple-accent font-medium\")}\n     | ^^^^^^^^^^^^^^^\n> 54 |         >\n     | ^^^^^^^^^^^^^^^\n> 55 |             {label}\n     | ^^^^^^^^^^^^^^^\n> 56 |             {sortBy === field && (order === 'asc' ? <ArrowUp size={14} /> : <ArrowDown size={14} />)}\n     | ^^^^^^^^^^^^^^^\n> 57 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 58 |     );\n     | ^^^^^^ The component is created during render here\n  59 |\n  60 |     if (isLoading) return <div className=\"p-12 text-center text-apple-subtext\">Loading Library...</div>;\n  61 |","line":94,"column":34,"nodeType":null,"endLine":94,"endColumn":44},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:95:34\n  93 |                                 <SortOption label=\"Title\" field=\"title\" />\n  94 |                                 <SortOption label=\"Artist\" field=\"artist\" />\n> 95 |                                 <SortOption label=\"Album\" field=\"album\" />\n     |                                  ^^^^^^^^^^ This component is created during render\n  96 |                                 <SortOption label=\"Duration\" field=\"duration\" />\n  97 |                                 <SortOption label=\"Date Added\" field=\"id\" />\n  98 |                             </div>\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:50:24\n  48 |     };\n  49 |\n> 50 |     const SortOption = ({ label, field }: { label: string, field: string }) => (\n     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 51 |         <button\n     | ^^^^^^^^^^^^^^^\n> 52 |             onClick={() => handleSort(field)}\n     | ^^^^^^^^^^^^^^^\n> 53 |             className={cn(\"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/5 flex justify-between items-center transition\", sortBy === field && \"text-apple-accent font-medium\")}\n     | ^^^^^^^^^^^^^^^\n> 54 |         >\n     | ^^^^^^^^^^^^^^^\n> 55 |             {label}\n     | ^^^^^^^^^^^^^^^\n> 56 |             {sortBy === field && (order === 'asc' ? <ArrowUp size={14} /> : <ArrowDown size={14} />)}\n     | ^^^^^^^^^^^^^^^\n> 57 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 58 |     );\n     | ^^^^^^ The component is created during render here\n  59 |\n  60 |     if (isLoading) return <div className=\"p-12 text-center text-apple-subtext\">Loading Library...</div>;\n  61 |","line":95,"column":34,"nodeType":null,"endLine":95,"endColumn":44},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:96:34\n  94 |                                 <SortOption label=\"Artist\" field=\"artist\" />\n  95 |                                 <SortOption label=\"Album\" field=\"album\" />\n> 96 |                                 <SortOption label=\"Duration\" field=\"duration\" />\n     |                                  ^^^^^^^^^^ This component is created during render\n  97 |                                 <SortOption label=\"Date Added\" field=\"id\" />\n  98 |                             </div>\n  99 |                         )}\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:50:24\n  48 |     };\n  49 |\n> 50 |     const SortOption = ({ label, field }: { label: string, field: string }) => (\n     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 51 |         <button\n     | ^^^^^^^^^^^^^^^\n> 52 |             onClick={() => handleSort(field)}\n     | ^^^^^^^^^^^^^^^\n> 53 |             className={cn(\"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/5 flex justify-between items-center transition\", sortBy === field && \"text-apple-accent font-medium\")}\n     | ^^^^^^^^^^^^^^^\n> 54 |         >\n     | ^^^^^^^^^^^^^^^\n> 55 |             {label}\n     | ^^^^^^^^^^^^^^^\n> 56 |             {sortBy === field && (order === 'asc' ? <ArrowUp size={14} /> : <ArrowDown size={14} />)}\n     | ^^^^^^^^^^^^^^^\n> 57 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 58 |     );\n     | ^^^^^^ The component is created during render here\n  59 |\n  60 |     if (isLoading) return <div className=\"p-12 text-center text-apple-subtext\">Loading Library...</div>;\n  61 |","line":96,"column":34,"nodeType":null,"endLine":96,"endColumn":44},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:97:34\n   95 |                                 <SortOption label=\"Album\" field=\"album\" />\n   96 |                                 <SortOption label=\"Duration\" field=\"duration\" />\n>  97 |                                 <SortOption label=\"Date Added\" field=\"id\" />\n      |                                  ^^^^^^^^^^ This component is created during render\n   98 |                             </div>\n   99 |                         )}\n  100 |                     </div>\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\SongList.tsx:50:24\n  48 |     };\n  49 |\n> 50 |     const SortOption = ({ label, field }: { label: string, field: string }) => (\n     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 51 |         <button\n     | ^^^^^^^^^^^^^^^\n> 52 |             onClick={() => handleSort(field)}\n     | ^^^^^^^^^^^^^^^\n> 53 |             className={cn(\"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/5 flex justify-between items-center transition\", sortBy === field && \"text-apple-accent font-medium\")}\n     | ^^^^^^^^^^^^^^^\n> 54 |         >\n     | ^^^^^^^^^^^^^^^\n> 55 |             {label}\n     | ^^^^^^^^^^^^^^^\n> 56 |             {sortBy === field && (order === 'asc' ? <ArrowUp size={14} /> : <ArrowDown size={14} />)}\n     | ^^^^^^^^^^^^^^^\n> 57 |         </button>\n     | ^^^^^^^^^^^^^^^\n> 58 |     );\n     | ^^^^^^ The component is created during render here\n  59 |\n  60 |     if (isLoading) return <div className=\"p-12 text-center text-apple-subtext\">Loading Library...</div>;\n  61 |","line":97,"column":34,"nodeType":null,"endLine":97,"endColumn":44}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { Virtuoso } from 'react-virtuoso';\r\nimport { getSongs, getCoverUrl } from '../lib/api';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { useThemeStore } from '../stores/themeStore';\r\nimport { formatTime, cn } from '../lib/utils';\r\nimport { Play, Music, Shuffle, Check, ArrowUp, ArrowDown, MoreVertical } from 'lucide-react';\r\nimport { AddToPlaylistModal } from './AddToPlaylistModal';\r\nimport { SongContextMenu, ArtistLink, AlbumLink } from './ContextMenu';\r\n\r\nexport function SongList() {\r\n    const [sortBy, setSortBy] = useState('title');\r\n    const [order, setOrder] = useState<'asc' | 'desc'>('asc');\r\n    const [showMenu, setShowMenu] = useState(false);\r\n\r\n    const { data: songs, isLoading } = useQuery({\r\n        queryKey: ['songs', sortBy, order],\r\n        queryFn: () => getSongs(0, 5000, sortBy, order),\r\n    });\r\n\r\n    const { playSong, currentSong, setQueue } = usePlayerStore();\r\n    const { showSongListArt, setShowSongListArt } = useThemeStore();\r\n    const [playlistModalSong, setPlaylistModalSong] = useState<number | null>(null);\r\n\r\n    const handlePlay = (song: any) => {\r\n        if (songs) setQueue(songs);\r\n        playSong(song);\r\n    };\r\n\r\n    const handleInstantPlay = () => {\r\n        if (!songs || songs.length === 0) return;\r\n        setQueue(songs);\r\n        usePlayerStore.setState({ isShuffle: false });\r\n        playSong(songs[0]);\r\n    };\r\n\r\n    const handleInstantShuffle = () => {\r\n        if (!songs || songs.length === 0) return;\r\n        const newQueue = [...songs].sort(() => Math.random() - 0.5);\r\n        usePlayerStore.setState({ isShuffle: true, queue: newQueue, originalQueue: songs });\r\n        playSong(newQueue[0]);\r\n    };\r\n\r\n    const handleSort = (field: string) => {\r\n        if (sortBy === field) setOrder(order === 'asc' ? 'desc' : 'asc');\r\n        else { setSortBy(field); setOrder('asc'); }\r\n    };\r\n\r\n    const SortOption = ({ label, field }: { label: string, field: string }) => (\r\n        <button\r\n            onClick={() => handleSort(field)}\r\n            className={cn(\"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/5 flex justify-between items-center transition\", sortBy === field && \"text-apple-accent font-medium\")}\r\n        >\r\n            {label}\r\n            {sortBy === field && (order === 'asc' ? <ArrowUp size={14} /> : <ArrowDown size={14} />)}\r\n        </button>\r\n    );\r\n\r\n    if (isLoading) return <div className=\"p-12 text-center text-apple-subtext\">Loading Library...</div>;\r\n\r\n    return (\r\n        <div className=\"w-full bg-apple-gray\">\r\n\r\n            {/* --- CONTROLS & HEADER --- */}\r\n            <div className=\"bg-apple-gray border-b border-gray-200 dark:border-white/10\">\r\n\r\n                {/* Top Row: Play Buttons & Menu */}\r\n                <div className=\"px-6 py-4 flex justify-between items-center\">\r\n                    <div className=\"flex gap-3\">\r\n                        <button onClick={handleInstantPlay} className=\"px-5 py-2 bg-gray-200 dark:bg-white/10 hover:bg-gray-300 dark:hover:bg-white/20 text-apple-text rounded-lg font-semibold flex items-center gap-2 transition shadow-sm text-sm\">\r\n                            <Play fill=\"currentColor\" size={16} /> Play\r\n                        </button>\r\n                        <button onClick={handleInstantShuffle} className=\"px-5 py-2 bg-gray-200 dark:bg-white/10 hover:bg-gray-300 dark:hover:bg-white/20 text-apple-text rounded-lg font-semibold flex items-center gap-2 transition shadow-sm text-sm\">\r\n                            <Shuffle size={16} /> Shuffle\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"relative\">\r\n                        <button onClick={() => setShowMenu(!showMenu)} className={cn(\"p-2 rounded-full transition\", showMenu ? \"bg-gray-200 dark:bg-white/10 text-apple-text\" : \"hover:bg-gray-200 dark:hover:bg-white/10 text-apple-subtext\")}>\r\n                            <MoreVertical size={20} />\r\n                        </button>\r\n\r\n                        {showMenu && (\r\n                            <div className=\"absolute right-0 top-10 w-56 bg-white dark:bg-[#2c2c2e] rounded-xl shadow-2xl border border-gray-200 dark:border-white/10 py-2 z-50 animate-in fade-in zoom-in-95 duration-100\">\r\n                                <div className=\"px-4 py-2 text-xs font-bold text-apple-subtext uppercase tracking-wider\">View</div>\r\n                                <button onClick={() => setShowSongListArt(!showSongListArt)} className=\"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/5 flex items-center justify-between text-apple-text transition\">\r\n                                    <span>Show Artwork</span>\r\n                                    {showSongListArt && <Check size={14} className=\"text-apple-accent\" />}\r\n                                </button>\r\n                                <div className=\"h-px bg-gray-100 dark:bg-white/5 my-2\" />\r\n                                <div className=\"px-4 py-2 text-xs font-bold text-apple-subtext uppercase tracking-wider\">Sort By</div>\r\n                                <SortOption label=\"Title\" field=\"title\" />\r\n                                <SortOption label=\"Artist\" field=\"artist\" />\r\n                                <SortOption label=\"Album\" field=\"album\" />\r\n                                <SortOption label=\"Duration\" field=\"duration\" />\r\n                                <SortOption label=\"Date Added\" field=\"id\" />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Bottom Row: Column Labels */}\r\n                <div className=\"flex items-center px-6 py-2 text-xs font-semibold text-apple-subtext uppercase tracking-wider bg-gray-50/50 dark:bg-white/5\">\r\n                    <div className=\"w-10 text-center\">#</div>\r\n                    {showSongListArt && <div className=\"w-12\"></div>}\r\n                    <div className=\"flex-1 pl-4 cursor-pointer hover:text-apple-text transition\" onClick={() => handleSort('title')}>Title</div>\r\n                    <div className=\"w-1/4 hidden md:block cursor-pointer hover:text-apple-text transition\" onClick={() => handleSort('artist')}>Artist</div>\r\n                    <div className=\"w-1/4 hidden lg:block cursor-pointer hover:text-apple-text transition pl-4\" onClick={() => handleSort('album')}>Album</div>\r\n                    <div className=\"w-16 text-right cursor-pointer hover:text-apple-text transition\" onClick={() => handleSort('duration')}>Time</div>\r\n                    <div className=\"w-10\"></div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* --- SCROLLABLE LIST (Calculated Height) --- */}\r\n            <div style={{ height: 'calc(100vh - 280px)' }}>\r\n                {!songs || songs.length === 0 ? (\r\n                    <div className=\"h-full flex flex-col items-center justify-center text-apple-subtext gap-2\">\r\n                        <Music size={48} className=\"opacity-20 mb-2\" />\r\n                        <p>No songs found.</p>\r\n                        <p className=\"text-xs\">Try resetting the library in Settings.</p>\r\n                    </div>\r\n                ) : (\r\n                    <Virtuoso\r\n                        style={{ height: '100%' }}\r\n                        data={songs}\r\n                        itemContent={(index, song) => {\r\n                            const isActive = currentSong?.id === song.id;\r\n                            return (\r\n                                <div\r\n                                    className={cn(\r\n                                        \"flex items-center px-6 py-1.5 hover:bg-gray-200/50 dark:hover:bg-white/5 cursor-pointer group/row transition-colors border-b border-gray-100 dark:border-white/5 h-14\",\r\n                                        isActive && \"bg-gray-200 dark:bg-white/10\"\r\n                                    )}\r\n                                    onClick={() => handlePlay(song)}\r\n                                >\r\n                                    <div className=\"w-10 text-center text-sm text-apple-subtext relative flex-shrink-0\">\r\n                                        <span className={cn(\"group-hover/row:hidden\", isActive && \"text-apple-accent font-bold\")}>{index + 1}</span>\r\n                                        <span className=\"hidden group-hover/row:flex items-center justify-center absolute inset-0\">\r\n                                            <Play size={14} fill=\"currentColor\" className={isActive ? \"text-apple-accent\" : \"text-apple-text\"} />\r\n                                        </span>\r\n                                    </div>\r\n\r\n                                    {showSongListArt && (\r\n                                        <div className=\"w-12 flex-shrink-0 flex justify-center\">\r\n                                            <div className=\"w-9 h-9 rounded bg-gray-200 dark:bg-white/10 relative overflow-hidden border border-black/5 dark:border-white/5\">\r\n                                                {song.album_id ? (\r\n                                                    <img src={getCoverUrl(song.album_id)} className=\"w-full h-full object-cover\" loading=\"lazy\" />\r\n                                                ) : <Music size={14} className=\"m-auto text-gray-400\" />}\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    <div className=\"flex-1 min-w-0 pl-4 pr-4\">\r\n                                        <div className={cn(\"font-medium truncate text-sm\", isActive ? \"text-apple-accent\" : \"text-apple-text\")}>\r\n                                            {song.title}\r\n                                        </div>\r\n                                        <div className=\"md:hidden text-[10px] text-apple-subtext truncate\">{song.artist}</div>\r\n                                    </div>\r\n\r\n                                    <div className=\"w-1/4 hidden md:block text-sm text-apple-subtext truncate\">\r\n                                        <ArtistLink name={song.artist} />\r\n                                    </div>\r\n\r\n                                    <div className=\"w-1/4 hidden lg:block text-sm text-apple-subtext truncate pl-4\">\r\n                                        {song.album?.title && song.album_id && (\r\n                                            <AlbumLink id={song.album_id} title={song.album.title} />\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    <div className=\"w-16 text-right text-sm text-apple-subtext tabular-nums\">{formatTime(song.duration)}</div>\r\n\r\n                                    <div className=\"w-10 flex items-center justify-center\">\r\n                                        <SongContextMenu\r\n                                            song={song}\r\n                                            onAddToPlaylist={() => setPlaylistModalSong(song.id)}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        }}\r\n                    />\r\n                )}\r\n            </div>\r\n\r\n            {playlistModalSong && <AddToPlaylistModal songIds={[playlistModalSong]} onClose={() => setPlaylistModalSong(null)} />}\r\n        </div>\r\n    );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\SquigglyProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\ToastContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\common\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\common\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\common\\IconButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\player\\QueuePanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'arrayMove' is defined but never used.","line":16,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[771,774],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[771,774],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'index' is defined but never used.","line":36,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":40}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Queue management panel with drag-and-drop\r\nimport { X, GripVertical, Trash2, ListMusic } from 'lucide-react';\r\nimport { usePlayerStore } from '../../stores/playerStore';\r\nimport { getCoverUrl } from '../../lib/api';\r\nimport { formatTime, cn } from '../../lib/utils';\r\nimport {\r\n    DndContext,\r\n    closestCenter,\r\n    KeyboardSensor,\r\n    PointerSensor,\r\n    useSensor,\r\n    useSensors,\r\n    DragEndEvent,\r\n} from '@dnd-kit/core';\r\nimport {\r\n    arrayMove,\r\n    SortableContext,\r\n    sortableKeyboardCoordinates,\r\n    useSortable,\r\n    verticalListSortingStrategy,\r\n} from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\n\r\ninterface QueuePanelProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\ninterface SortableSongItemProps {\r\n    song: any;\r\n    index: number;\r\n    isCurrent: boolean;\r\n    onRemove: () => void;\r\n}\r\n\r\nfunction SortableSongItem({ song, index, isCurrent, onRemove }: SortableSongItemProps) {\r\n    const { playSong, queue } = usePlayerStore();\r\n    const {\r\n        attributes,\r\n        listeners,\r\n        setNodeRef,\r\n        transform,\r\n        transition,\r\n        isDragging,\r\n    } = useSortable({ id: song.id });\r\n\r\n    const style = {\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n    };\r\n\r\n    return (\r\n        <div\r\n            ref={setNodeRef}\r\n            style={style}\r\n            className={cn(\r\n                \"flex items-center gap-3 p-2 rounded-lg group transition-colors\",\r\n                isCurrent ? \"bg-apple-accent/10\" : \"hover:bg-gray-100 dark:hover:bg-white/5\",\r\n                isDragging && \"opacity-50\"\r\n            )}\r\n        >\r\n            <button\r\n                {...attributes}\r\n                {...listeners}\r\n                className=\"cursor-grab active:cursor-grabbing text-apple-subtext hover:text-apple-text transition p-1\"\r\n            >\r\n                <GripVertical size={16} />\r\n            </button>\r\n\r\n            <img\r\n                src={getCoverUrl(song.album_id)}\r\n                alt={song.title}\r\n                className=\"w-10 h-10 rounded object-cover\"\r\n            />\r\n\r\n            <div\r\n                className=\"flex-1 min-w-0 cursor-pointer\"\r\n                onClick={() => {\r\n                    usePlayerStore.getState().setQueue(queue);\r\n                    playSong(song);\r\n                }}\r\n            >\r\n                <div className={cn(\r\n                    \"text-sm font-medium truncate\",\r\n                    isCurrent ? \"text-apple-accent\" : \"text-apple-text\"\r\n                )}>\r\n                    {song.title}\r\n                </div>\r\n                <div className=\"text-xs text-apple-subtext truncate\">\r\n                    {song.artist}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"text-xs text-apple-subtext tabular-nums\">\r\n                {formatTime(song.duration)}\r\n            </div>\r\n\r\n            {!isCurrent && (\r\n                <button\r\n                    onClick={onRemove}\r\n                    className=\"opacity-0 group-hover:opacity-100 p-1 text-apple-subtext hover:text-red-500 transition\"\r\n                >\r\n                    <Trash2 size={14} />\r\n                </button>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function QueuePanel({ isOpen, onClose }: QueuePanelProps) {\r\n    const { queue, currentSong, currentIndex, reorderQueue, removeFromQueue, clearQueue } = usePlayerStore();\r\n\r\n    const sensors = useSensors(\r\n        useSensor(PointerSensor),\r\n        useSensor(KeyboardSensor, {\r\n            coordinateGetter: sortableKeyboardCoordinates,\r\n        })\r\n    );\r\n\r\n    const handleDragEnd = (event: DragEndEvent) => {\r\n        const { active, over } = event;\r\n\r\n        if (over && active.id !== over.id) {\r\n            const oldIndex = queue.findIndex((song) => song.id === active.id);\r\n            const newIndex = queue.findIndex((song) => song.id === over.id);\r\n            reorderQueue(oldIndex, newIndex);\r\n        }\r\n    };\r\n\r\n    const upcomingSongs = queue.slice(currentIndex + 1);\r\n\r\n    return (\r\n        <>\r\n            {/* Backdrop */}\r\n            <div\r\n                className={cn(\r\n                    \"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity z-40\",\r\n                    isOpen ? \"opacity-100\" : \"opacity-0 pointer-events-none\"\r\n                )}\r\n                onClick={onClose}\r\n            />\r\n\r\n            {/* Panel */}\r\n            <div\r\n                className={cn(\r\n                    \"fixed top-0 right-0 h-full w-96 bg-white dark:bg-gray-900 shadow-2xl transform transition-transform duration-300 ease-out z-50 flex flex-col\",\r\n                    isOpen ? \"translate-x-0\" : \"translate-x-full\"\r\n                )}\r\n            >\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-white/10\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <ListMusic size={20} className=\"text-apple-accent\" />\r\n                        <h2 className=\"text-lg font-semibold text-apple-text\">\r\n                            Queue ({queue.length})\r\n                        </h2>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {queue.length > 0 && (\r\n                            <button\r\n                                onClick={clearQueue}\r\n                                className=\"text-xs text-apple-subtext hover:text-red-500 transition px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-white/5\"\r\n                            >\r\n                                Clear All\r\n                            </button>\r\n                        )}\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"p-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-full transition\"\r\n                        >\r\n                            <X size={20} className=\"text-apple-subtext\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 overflow-y-auto p-4\">\r\n                    {queue.length === 0 ? (\r\n                        <div className=\"flex flex-col items-center justify-center h-full text-center\">\r\n                            <ListMusic size={48} className=\"text-apple-subtext/30 mb-4\" />\r\n                            <p className=\"text-apple-subtext\">Queue is empty</p>\r\n                            <p className=\"text-xs text-apple-subtext/70 mt-1\">\r\n                                Play a song to start your queue\r\n                            </p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-6\">\r\n                            {/* Now Playing */}\r\n                            {currentSong && (\r\n                                <div>\r\n                                    <h3 className=\"text-xs font-semibold text-apple-subtext uppercase tracking-wider mb-2\">\r\n                                        Now Playing\r\n                                    </h3>\r\n                                    <div className=\"flex items-center gap-3 p-3 rounded-lg bg-apple-accent/10 border border-apple-accent/20\">\r\n                                        <img\r\n                                            src={getCoverUrl(currentSong.album_id)}\r\n                                            alt={currentSong.title}\r\n                                            className=\"w-12 h-12 rounded object-cover\"\r\n                                        />\r\n                                        <div className=\"flex-1 min-w-0\">\r\n                                            <div className=\"text-sm font-semibold text-apple-accent truncate\">\r\n                                                {currentSong.title}\r\n                                            </div>\r\n                                            <div className=\"text-xs text-apple-subtext truncate\">\r\n                                                {currentSong.artist}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"text-xs text-apple-subtext tabular-nums\">\r\n                                            {formatTime(currentSong.duration)}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Next Up */}\r\n                            {upcomingSongs.length > 0 && (\r\n                                <div>\r\n                                    <h3 className=\"text-xs font-semibold text-apple-subtext uppercase tracking-wider mb-2\">\r\n                                        Next Up ({upcomingSongs.length})\r\n                                    </h3>\r\n                                    <DndContext\r\n                                        sensors={sensors}\r\n                                        collisionDetection={closestCenter}\r\n                                        onDragEnd={handleDragEnd}\r\n                                    >\r\n                                        <SortableContext\r\n                                            items={upcomingSongs.map(s => s.id)}\r\n                                            strategy={verticalListSortingStrategy}\r\n                                        >\r\n                                            <div className=\"space-y-1\">\r\n                                                {upcomingSongs.map((song, idx) => (\r\n                                                    <SortableSongItem\r\n                                                        key={song.id}\r\n                                                        song={song}\r\n                                                        index={currentIndex + 1 + idx}\r\n                                                        isCurrent={false}\r\n                                                        onRemove={() => removeFromQueue(currentIndex + 1 + idx)}\r\n                                                    />\r\n                                                ))}\r\n                                            </div>\r\n                                        </SortableContext>\r\n                                    </DndContext>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\player\\SyncedLyrics.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\player\\SyncedLyrics.tsx:47:9\n  45 |     useEffect(() => {\n  46 |         const lines = parseLRC(lyrics);\n> 47 |         setParsedLines(lines);\n     |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  48 |     }, [lyrics]);\n  49 |\n  50 |     // Update current line based on time with offset to sync better","line":47,"column":9,"nodeType":null,"endLine":47,"endColumn":23},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\player\\SyncedLyrics.tsx:67:9\n  65 |         }\n  66 |\n> 67 |         setCurrentLineIndex(index);\n     |         ^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  68 |     }, [currentTime, parsedLines]);\n  69 |\n  70 |     // Auto-scroll to current line","line":67,"column":9,"nodeType":null,"endLine":67,"endColumn":28}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Synced lyrics component with auto-scroll\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { cn } from '../../lib/utils';\r\n\r\ninterface LyricLine {\r\n    time: number;\r\n    text: string;\r\n}\r\n\r\ninterface SyncedLyricsProps {\r\n    lyrics: string;\r\n    currentTime: number;\r\n    className?: string;\r\n}\r\n\r\n// Parse LRC format lyrics\r\nfunction parseLRC(lrc: string): LyricLine[] {\r\n    const lines: LyricLine[] = [];\r\n    const lrcLines = lrc.split('\\n');\r\n\r\n    for (const line of lrcLines) {\r\n        // Match [mm:ss.xx] or [mm:ss] format\r\n        const match = line.match(/\\[(\\d{2}):(\\d{2})(?:\\.(\\d{2,3}))?\\](.*)/);\r\n        if (match) {\r\n            const minutes = parseInt(match[1]);\r\n            const seconds = parseInt(match[2]);\r\n            const milliseconds = match[3] ? parseInt(match[3].padEnd(3, '0')) : 0;\r\n            const text = match[4].trim();\r\n\r\n            const time = minutes * 60 + seconds + milliseconds / 1000;\r\n            lines.push({ time, text });\r\n        }\r\n    }\r\n\r\n    return lines.sort((a, b) => a.time - b.time);\r\n}\r\n\r\nexport function SyncedLyrics({ lyrics, currentTime, className }: SyncedLyricsProps) {\r\n    const [parsedLines, setParsedLines] = useState<LyricLine[]>([]);\r\n    const [currentLineIndex, setCurrentLineIndex] = useState(-1);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const activeLineRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Parse lyrics on mount or when lyrics change\r\n    useEffect(() => {\r\n        const lines = parseLRC(lyrics);\r\n        setParsedLines(lines);\r\n    }, [lyrics]);\r\n\r\n    // Update current line based on time with offset to sync better\r\n    useEffect(() => {\r\n        if (parsedLines.length === 0) return;\r\n\r\n        // Add 0.3s offset to account for processing delay and make it feel more responsive\r\n        const adjustedTime = currentTime + 0.3;\r\n\r\n        // Find the current line (last line whose time has passed)\r\n        let index = -1;\r\n        for (let i = 0; i < parsedLines.length; i++) {\r\n            if (parsedLines[i].time <= adjustedTime) {\r\n                index = i;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        setCurrentLineIndex(index);\r\n    }, [currentTime, parsedLines]);\r\n\r\n    // Auto-scroll to current line\r\n    useEffect(() => {\r\n        if (activeLineRef.current && containerRef.current) {\r\n            const container = containerRef.current;\r\n            const activeLine = activeLineRef.current;\r\n\r\n            const containerHeight = container.clientHeight;\r\n            const lineTop = activeLine.offsetTop;\r\n            const lineHeight = activeLine.clientHeight;\r\n\r\n            // Scroll so the active line is centered\r\n            const scrollTo = lineTop - containerHeight / 2 + lineHeight / 2;\r\n\r\n            container.scrollTo({\r\n                top: scrollTo,\r\n                behavior: 'smooth'\r\n            });\r\n        }\r\n    }, [currentLineIndex]);\r\n\r\n    if (parsedLines.length === 0) {\r\n        return (\r\n            <div className={cn(\"whitespace-pre-wrap text-2xl font-bold text-white/80 leading-relaxed space-y-8 pb-20 px-4\", className)}>\r\n                {lyrics}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div ref={containerRef} className={cn(\"overflow-y-auto no-scrollbar pb-20\", className)}>\r\n            <div className=\"space-y-6 pt-[40vh] px-4\">\r\n                {parsedLines.map((line, index) => (\r\n                    <div\r\n                        key={index}\r\n                        ref={index === currentLineIndex ? activeLineRef : null}\r\n                        className={cn(\r\n                            \"transition-all duration-300 leading-relaxed cursor-pointer hover:text-white\",\r\n                            index === currentLineIndex\r\n                                ? \"text-3xl font-bold text-white scale-105\"\r\n                                : index < currentLineIndex\r\n                                    ? \"text-xl text-white/30\"\r\n                                    : \"text-xl text-white/50\"\r\n                        )}\r\n                    >\r\n                        {line.text || 'ΓÖ¬'}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\DangerZone.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\LibraryPathManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Button' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":16},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadPaths` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\LibraryPathManager.tsx:22:9\n  20 |\n  21 |     useEffect(() => {\n> 22 |         loadPaths();\n     |         ^^^^^^^^^ `loadPaths` accessed before it is declared\n  23 |     }, []);\n  24 |\n  25 |     const loadPaths = async () => {\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\LibraryPathManager.tsx:25:5\n  23 |     }, []);\n  24 |\n> 25 |     const loadPaths = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 26 |         try {\n     | ^^^^^^^^^^^^^\n> 27 |             const res = await api.get<LibraryPath[]>('/library/paths');\n     | ^^^^^^^^^^^^^\n> 28 |             setPaths(res.data);\n     | ^^^^^^^^^^^^^\n> 29 |         } catch (e) {\n     | ^^^^^^^^^^^^^\n> 30 |             console.error('Failed to load paths:', e);\n     | ^^^^^^^^^^^^^\n> 31 |         }\n     | ^^^^^^^^^^^^^\n> 32 |     };\n     | ^^^^^^^ `loadPaths` is declared here\n  33 |\n  34 |     const handleAddPath = async () => {\n  35 |         if (!newPath.trim()) return;","line":22,"column":9,"nodeType":null,"endLine":22,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":40,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'id' is defined but never used.","line":74,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":31}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Library path manager component with CRUD operations\r\nimport { useState, useEffect } from 'react';\r\nimport { Plus, Trash2, Edit2, Check, X } from 'lucide-react';\r\nimport api from '../../lib/api';\r\nimport { Card } from '../common/Card';\r\nimport { Button } from '../common/Button';\r\nimport { IconButton } from '../common/IconButton';\r\nimport { useConfirm } from '../../stores/confirmStore';\r\n\r\ninterface LibraryPath {\r\n    id: number;\r\n    path: string;\r\n}\r\n\r\nexport function LibraryPathManager() {\r\n    const [paths, setPaths] = useState<LibraryPath[]>([]);\r\n    const [newPath, setNewPath] = useState('');\r\n    const [editingId, setEditingId] = useState<number | null>(null);\r\n    const [editingPath, setEditingPath] = useState('');\r\n\r\n    useEffect(() => {\r\n        loadPaths();\r\n    }, []);\r\n\r\n    const loadPaths = async () => {\r\n        try {\r\n            const res = await api.get<LibraryPath[]>('/library/paths');\r\n            setPaths(res.data);\r\n        } catch (e) {\r\n            console.error('Failed to load paths:', e);\r\n        }\r\n    };\r\n\r\n    const handleAddPath = async () => {\r\n        if (!newPath.trim()) return;\r\n        try {\r\n            await api.post('/library/paths', { path: newPath });\r\n            setNewPath('');\r\n            loadPaths();\r\n        } catch (e) {\r\n            alert('Invalid path or server error');\r\n        }\r\n    };\r\n\r\n    const confirm = useConfirm();\r\n\r\n    const handleRemovePath = async (id: number) => {\r\n        const confirmed = await confirm({\r\n            title: 'Remove Library Path',\r\n            message: 'Remove this folder from your library? Your files will not be deleted.',\r\n            confirmText: 'Remove',\r\n            variant: 'warning',\r\n        });\r\n\r\n        if (!confirmed) return;\r\n        try {\r\n            await api.delete(`/library/paths/${id}`);\r\n            loadPaths();\r\n        } catch (e) {\r\n            console.error('Failed to remove path:', e);\r\n        }\r\n    };\r\n\r\n    const startEditing = (path: LibraryPath) => {\r\n        setEditingId(path.id);\r\n        setEditingPath(path.path);\r\n    };\r\n\r\n    const cancelEditing = () => {\r\n        setEditingId(null);\r\n        setEditingPath('');\r\n    };\r\n\r\n    const saveEdit = async (id: number) => {\r\n        if (!editingPath.trim()) return;\r\n        try {\r\n            // Note: Backend doesn't have edit endpoint yet, would need to add\r\n            // For now, just cancel editing\r\n            cancelEditing();\r\n            // TODO: Implement backend PATCH /library/paths/{id}\r\n        } catch (e) {\r\n            console.error('Failed to edit path:', e);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Card>\r\n            <div className=\"space-y-4\">\r\n                <h4 className=\"text-sm font-semibold text-apple-subtext uppercase tracking-wider\">Music Folders</h4>\r\n\r\n                {/* Path List */}\r\n                <div className=\"space-y-2\">\r\n                    {paths.length === 0 && (\r\n                        <p className=\"text-sm text-apple-subtext italic\">No folders added yet.</p>\r\n                    )}\r\n                    {paths.map(p => (\r\n                        <div\r\n                            key={p.id}\r\n                            className=\"flex items-center justify-between bg-gray-100 dark:bg-white/5 p-3 rounded-lg border border-transparent hover:border-gray-200 dark:hover:border-white/10 transition\"\r\n                        >\r\n                            {editingId === p.id ? (\r\n                                <>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={editingPath}\r\n                                        onChange={(e) => setEditingPath(e.target.value)}\r\n                                        className=\"flex-1 px-2 py-1 text-sm bg-white dark:bg-black/20 border border-gray-300 dark:border-white/20 rounded text-apple-text focus:outline-none focus:ring-2 focus:ring-apple-accent/50\"\r\n                                        autoFocus\r\n                                    />\r\n                                    <div className=\"flex gap-1 ml-2\">\r\n                                        <IconButton\r\n                                            icon={<Check size={16} />}\r\n                                            onClick={() => saveEdit(p.id)}\r\n                                            variant=\"accent\"\r\n                                            size=\"sm\"\r\n                                            tooltip=\"Save\"\r\n                                        />\r\n                                        <IconButton\r\n                                            icon={<X size={16} />}\r\n                                            onClick={cancelEditing}\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            tooltip=\"Cancel\"\r\n                                        />\r\n                                    </div>\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <span className=\"text-sm font-mono text-apple-text truncate px-2 flex-1\">{p.path}</span>\r\n                                    <div className=\"flex gap-1\">\r\n                                        <IconButton\r\n                                            icon={<Edit2 size={16} />}\r\n                                            onClick={() => startEditing(p)}\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            tooltip=\"Edit path\"\r\n                                        />\r\n                                        <IconButton\r\n                                            icon={<Trash2 size={16} />}\r\n                                            onClick={() => handleRemovePath(p.id)}\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            tooltip=\"Remove path\"\r\n                                            className=\"hover:text-red-500\"\r\n                                        />\r\n                                    </div>\r\n                                </>\r\n                            )}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Add New Path */}\r\n                <div className=\"flex gap-2\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={newPath}\r\n                        onChange={(e) => setNewPath(e.target.value)}\r\n                        onKeyDown={(e) => e.key === 'Enter' && handleAddPath()}\r\n                        placeholder=\"e.g. D:/Music or /home/user/Music\"\r\n                        className=\"flex-1 p-3 text-sm rounded-lg border border-gray-200 dark:border-white/10 bg-white dark:bg-black/20 text-apple-text focus:outline-none focus:ring-2 focus:ring-apple-accent/50\"\r\n                    />\r\n                    <IconButton\r\n                        icon={<Plus size={20} />}\r\n                        onClick={handleAddPath}\r\n                        variant=\"default\"\r\n                        tooltip=\"Add folder\"\r\n                    />\r\n                </div>\r\n            </div>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\ScannerControl.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`checkScanStatus` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\ScannerControl.tsx:51:9\n  49 |\n  50 |     useEffect(() => {\n> 51 |         checkScanStatus();\n     |         ^^^^^^^^^^^^^^^ `checkScanStatus` accessed before it is declared\n  52 |         return () => {\n  53 |             if (pollInterval.current) {\n  54 |                 clearInterval(pollInterval.current);\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\ScannerControl.tsx:59:5\n  57 |     }, []);\n  58 |\n> 59 |     const checkScanStatus = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 60 |         try {\n     | ^^^^^^^^^^^^^\n> 61 |             const res = await api.get<ScanProgress>('/library/scan/status');\n     ΓÇª\n     | ^^^^^^^^^^^^^\n> 74 |         }\n     | ^^^^^^^^^^^^^\n> 75 |     };\n     | ^^^^^^^ `checkScanStatus` is declared here\n  76 |\n  77 |     const startPolling = () => {\n  78 |         pollInterval.current = setInterval(checkScanStatus, 500);","line":51,"column":9,"nodeType":null,"endLine":51,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkScanStatus'. Either include it or remove the dependency array.","line":57,"column":8,"nodeType":"ArrayExpression","endLine":57,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [checkScanStatus]","fix":{"range":[1694,1696],"text":"[checkScanStatus]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2194,2197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2194,2197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":94,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2877,2880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2877,2880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nZ:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\ScannerControl.tsx:112:37\n  110 |     const getElapsedTime = () => {\n  111 |         if (!progress.start_time) return '0s';\n> 112 |         const elapsed = Math.floor((Date.now() - progress.start_time) / 1000);\n      |                                     ^^^^^^^^^^ Cannot call impure function\n  113 |         const mins = Math.floor(elapsed / 60);\n  114 |         const secs = elapsed % 60;\n  115 |         return mins > 0 ? `${mins}m ${secs}s` : `${secs}s`;","line":112,"column":37,"nodeType":null,"endLine":112,"endColumn":47}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Scanner control with progress tracking and error details\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { RefreshCw, StopCircle, CheckCircle, AlertCircle, Clock, ChevronDown, ChevronUp } from 'lucide-react';\r\nimport api from '../../lib/api';\r\nimport { Card } from '../common/Card';\r\nimport { Button } from '../common/Button';\r\n\r\ninterface ErrorDetail {\r\n    file_path: string;\r\n    error_message: string;\r\n    timestamp: string;\r\n}\r\n\r\ninterface LastScanResult {\r\n    files_processed: number;\r\n    songs_added: number;\r\n    errors: number;\r\n    duration: number;\r\n    completed_at: string;\r\n    error_details: ErrorDetail[];\r\n}\r\n\r\ninterface ScanProgress {\r\n    is_scanning: boolean;\r\n    files_processed: number;\r\n    songs_added: number;\r\n    errors: number;\r\n    current_file: string;\r\n    start_time: number | null;\r\n    error_details: ErrorDetail[];\r\n    last_scan_result: LastScanResult | null;\r\n}\r\n\r\nexport function ScannerControl() {\r\n    const [isScanning, setIsScanning] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [showErrors, setShowErrors] = useState(false);\r\n    const [progress, setProgress] = useState<ScanProgress>({\r\n        is_scanning: false,\r\n        files_processed: 0,\r\n        songs_added: 0,\r\n        errors: 0,\r\n        current_file: '',\r\n        start_time: null,\r\n        error_details: [],\r\n        last_scan_result: null\r\n    });\r\n    const pollInterval = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    useEffect(() => {\r\n        checkScanStatus();\r\n        return () => {\r\n            if (pollInterval.current) {\r\n                clearInterval(pollInterval.current);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    const checkScanStatus = async () => {\r\n        try {\r\n            const res = await api.get<ScanProgress>('/library/scan/status');\r\n            setProgress(res.data);\r\n            setIsScanning(res.data.is_scanning);\r\n            setError(null);\r\n\r\n            if (res.data.is_scanning && !pollInterval.current) {\r\n                startPolling();\r\n            } else if (!res.data.is_scanning && pollInterval.current) {\r\n                stopPolling();\r\n            }\r\n        } catch (e: any) {\r\n            console.error('Failed to get scan status:', e);\r\n            setError(e.response?.data?.detail || 'Failed to connect to scanner');\r\n        }\r\n    };\r\n\r\n    const startPolling = () => {\r\n        pollInterval.current = setInterval(checkScanStatus, 500);\r\n    };\r\n\r\n    const stopPolling = () => {\r\n        if (pollInterval.current) {\r\n            clearInterval(pollInterval.current);\r\n            pollInterval.current = null;\r\n        }\r\n    };\r\n\r\n    const handleStartScan = async () => {\r\n        try {\r\n            setError(null);\r\n            setIsScanning(true);\r\n            await api.post('/library/scan');\r\n            startPolling();\r\n        } catch (e: any) {\r\n            console.error('Failed to start scan:', e);\r\n            setError(e.response?.data?.detail || 'Failed to start scan');\r\n            setIsScanning(false);\r\n        }\r\n    };\r\n\r\n    const handleStopScan = async () => {\r\n        try {\r\n            stopPolling();\r\n            setIsScanning(false);\r\n        } catch (e) {\r\n            console.error('Failed to stop scan:', e);\r\n        }\r\n    };\r\n\r\n    const getElapsedTime = () => {\r\n        if (!progress.start_time) return '0s';\r\n        const elapsed = Math.floor((Date.now() - progress.start_time) / 1000);\r\n        const mins = Math.floor(elapsed / 60);\r\n        const secs = elapsed % 60;\r\n        return mins > 0 ? `${mins}m ${secs}s` : `${secs}s`;\r\n    };\r\n\r\n    const formatDuration = (seconds: number) => {\r\n        const mins = Math.floor(seconds / 60);\r\n        const secs = Math.floor(seconds % 60);\r\n        return mins > 0 ? `${mins}m ${secs}s` : `${secs}s`;\r\n    };\r\n\r\n    const formatDate = (isoString: string) => {\r\n        const date = new Date(isoString);\r\n        return date.toLocaleString();\r\n    };\r\n\r\n    const getFileName = (path: string) => {\r\n        return path.split(/[/\\\\]/).pop() || path;\r\n    };\r\n\r\n    return (\r\n        <Card className=\"mt-4\">\r\n            <div className=\"space-y-4\">\r\n                <h4 className=\"text-sm font-semibold text-apple-subtext uppercase tracking-wider\">Library Scanner</h4>\r\n\r\n                {error && (\r\n                    <div className=\"flex items-start gap-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg\">\r\n                        <AlertCircle size={18} className=\"text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5\" />\r\n                        <div className=\"flex-1\">\r\n                            <div className=\"text-sm font-medium text-red-700 dark:text-red-300\">Scan Error</div>\r\n                            <div className=\"text-xs text-red-600 dark:text-red-400 mt-1\">{error}</div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {!isScanning ? (\r\n                    <Button onClick={handleStartScan} variant=\"primary\" className=\"w-full\" disabled={isScanning}>\r\n                        <RefreshCw size={18} />\r\n                        Scan All Folders\r\n                    </Button>\r\n                ) : (\r\n                    <Button onClick={handleStopScan} variant=\"danger\" className=\"w-full\">\r\n                        <StopCircle size={18} />\r\n                        Stop Scanning\r\n                    </Button>\r\n                )}\r\n\r\n                {isScanning && (\r\n                    <div className=\"space-y-3 p-4 bg-gray-50 dark:bg-black/20 rounded-lg border border-gray-200 dark:border-white/10\">\r\n                        <div className=\"space-y-1\">\r\n                            <div className=\"flex justify-between text-xs text-apple-subtext\">\r\n                                <span>Scanning...</span>\r\n                                <span>{getElapsedTime()}</span>\r\n                            </div>\r\n                            <div className=\"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden\">\r\n                                <div className=\"h-full bg-apple-accent transition-all duration-300 rounded-full\" style={{ width: '100%' }}>\r\n                                    <div className=\"h-full w-full bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {progress.current_file && (\r\n                            <div className=\"text-xs text-apple-subtext truncate\">\r\n                                ≡ƒôü {getFileName(progress.current_file)}\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"grid grid-cols-3 gap-3 pt-2 border-t border-gray-200 dark:border-white/10\">\r\n                            <div className=\"text-center\">\r\n                                <div className=\"text-lg font-semibold text-apple-text\">{progress.files_processed}</div>\r\n                                <div className=\"text-xs text-apple-subtext\">Files</div>\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                                <div className=\"text-lg font-semibold text-green-500\">{progress.songs_added}</div>\r\n                                <div className=\"text-xs text-apple-subtext\">Added</div>\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                                <div className=\"text-lg font-semibold text-red-500\">{progress.errors}</div>\r\n                                <div className=\"text-xs text-apple-subtext\">Errors</div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Live error list during scan */}\r\n                        {progress.error_details.length > 0 && (\r\n                            <div className=\"pt-2 border-t border-gray-200 dark:border-white/10\">\r\n                                <button\r\n                                    onClick={() => setShowErrors(!showErrors)}\r\n                                    className=\"flex items-center justify-between w-full text-xs font-medium text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition\"\r\n                                >\r\n                                    <span>{progress.error_details.length} file{progress.error_details.length !== 1 ? 's' : ''} failed</span>\r\n                                    {showErrors ? <ChevronUp size={14} /> : <ChevronDown size={14} />}\r\n                                </button>\r\n                                {showErrors && (\r\n                                    <div className=\"mt-2 max-h-40 overflow-y-auto space-y-1\">\r\n                                        {progress.error_details.map((err, idx) => (\r\n                                            <div key={idx} className=\"text-xs p-2 bg-red-50 dark:bg-red-900/10 rounded border border-red-200 dark:border-red-800\">\r\n                                                <div className=\"font-medium text-red-700 dark:text-red-300 truncate\" title={err.file_path}>\r\n                                                    {getFileName(err.file_path)}\r\n                                                </div>\r\n                                                <div className=\"text-red-600 dark:text-red-400 mt-0.5\">{err.error_message}</div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {!isScanning && progress.last_scan_result && (\r\n                    <div className=\"space-y-2 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <CheckCircle size={18} className=\"text-blue-600 dark:text-blue-400\" />\r\n                                <span className=\"text-sm font-semibold text-blue-700 dark:text-blue-300\">Last Scan Complete</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1 text-xs text-blue-600 dark:text-blue-400\">\r\n                                <Clock size={12} />\r\n                                {formatDuration(progress.last_scan_result.duration)}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-3 gap-2 mt-2\">\r\n                            <div className=\"text-center p-2 bg-white/50 dark:bg-black/20 rounded\">\r\n                                <div className=\"text-sm font-bold text-blue-700 dark:text-blue-300\">{progress.last_scan_result.files_processed}</div>\r\n                                <div className=\"text-xs text-blue-600 dark:text-blue-400\">Files</div>\r\n                            </div>\r\n                            <div className=\"text-center p-2 bg-white/50 dark:bg-black/20 rounded\">\r\n                                <div className=\"text-sm font-bold text-green-600 dark:text-green-400\">{progress.last_scan_result.songs_added}</div>\r\n                                <div className=\"text-xs text-blue-600 dark:text-blue-400\">Added</div>\r\n                            </div>\r\n                            <div className=\"text-center p-2 bg-white/50 dark:bg-black/20 rounded\">\r\n                                <div className=\"text-sm font-bold text-red-600 dark:text-red-400\">{progress.last_scan_result.errors}</div>\r\n                                <div className=\"text-xs text-blue-600 dark:text-blue-400\">Errors</div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"text-xs text-blue-600 dark:text-blue-400 mt-2\">\r\n                            Completed: {formatDate(progress.last_scan_result.completed_at)}\r\n                        </div>\r\n\r\n                        {/* Error details from last scan */}\r\n                        {progress.last_scan_result.error_details && progress.last_scan_result.error_details.length > 0 && (\r\n                            <div className=\"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700\">\r\n                                <button\r\n                                    onClick={() => setShowErrors(!showErrors)}\r\n                                    className=\"flex items-center justify-between w-full text-xs font-medium text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition\"\r\n                                >\r\n                                    <span>View {progress.last_scan_result.error_details.length} failed file{progress.last_scan_result.error_details.length !== 1 ? 's' : ''}</span>\r\n                                    {showErrors ? <ChevronUp size={14} /> : <ChevronDown size={14} />}\r\n                                </button>\r\n                                {showErrors && (\r\n                                    <div className=\"mt-2 max-h-60 overflow-y-auto space-y-1\">\r\n                                        {progress.last_scan_result.error_details.map((err, idx) => (\r\n                                            <div key={idx} className=\"text-xs p-2 bg-red-50 dark:bg-red-900/10 rounded border border-red-200 dark:border-red-800\">\r\n                                                <div className=\"font-medium text-red-700 dark:text-red-300 truncate\" title={err.file_path}>\r\n                                                    ≡ƒôä {getFileName(err.file_path)}\r\n                                                </div>\r\n                                                <div className=\"text-red-600 dark:text-red-400 mt-0.5\">{err.error_message}</div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\components\\settings\\ThemeSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\hooks\\useKeyboardShortcuts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\lib\\animations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\lib\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\lib\\utils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1593,1596],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1593,1596],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1603,1606],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1603,1606],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { clsx, type ClassValue } from \"clsx\";\r\nimport { twMerge } from \"tailwind-merge\";\r\n\r\n// Helper to merge Tailwind classes safely (e.g. dealing with conflicts)\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n\r\n// Helper to convert raw seconds (e.g. 125.5) into \"2:05\"\r\nexport function formatTime(seconds: number): string {\r\n  if (!seconds || isNaN(seconds)) return \"0:00\";\r\n  const mins = Math.floor(seconds / 60);\r\n  const secs = Math.floor(seconds % 60);\r\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n}\r\n\r\nexport function formatSize(bytes: number): string {\r\n  if (bytes === 0) return '0 B';\r\n  const k = 1024;\r\n  const sizes = ['B', 'KB', 'MB', 'GB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\r\n}\r\n\r\n// Format bitrate\r\nexport function formatBitrate(kbps: number | null | undefined): string {\r\n  if (!kbps) return 'Unknown';\r\n  return `${kbps} kbps`;\r\n}\r\n\r\n// Format sample rate\r\nexport function formatSampleRate(hz: number | null | undefined): string {\r\n  if (!hz) return 'Unknown';\r\n  if (hz >= 1000) {\r\n    return `${(hz / 1000).toFixed(1)} kHz`;\r\n  }\r\n  return `${hz} Hz`;\r\n}\r\n\r\n// Format channels\r\nexport function formatChannels(channels: number | null | undefined): string {\r\n  if (!channels) return 'Unknown';\r\n  if (channels === 1) return 'Mono';\r\n  if (channels === 2) return 'Stereo';\r\n  if (channels === 6) return '5.1 Surround';\r\n  return `${channels} channels`;\r\n}\r\n\r\n// Debounce function\r\nexport function debounce<T extends (...args: any[]) => any>(\r\n  func: T,\r\n  wait: number\r\n): (...args: Parameters<T>) => void {\r\n  let timeout: NodeJS.Timeout;\r\n  return (...args: Parameters<T>) => {\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => func(...args), wait);\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\AlbumDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\AlbumsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Check' is defined but never used.","line":7,"column":65,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":70},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[713,716],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[713,716],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":44,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":56,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":17}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { getAlbums, getCoverUrl, getAlbumSongs } from '../lib/api';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { useToastStore } from '../stores/toastStore';\r\nimport { Disc, MoreVertical, Play, ListPlus, User, ArrowUpDown, Check } from 'lucide-react';\r\nimport { AlbumGridSkeleton } from '../components/Skeletons';\r\nimport { ArtistLink } from '../components/ContextMenu';\r\n\r\ntype SortField = 'title' | 'artist' | 'year';\r\ntype SortOrder = 'asc' | 'desc';\r\n\r\n// --- Album Card with Context Menu ---\r\nfunction AlbumCard({ album }: { album: any }) {\r\n  const navigate = useNavigate();\r\n  const [imageError, setImageError] = useState(false);\r\n  const [showMenu, setShowMenu] = useState(false);\r\n  const menuRef = useRef<HTMLDivElement>(null);\r\n  const { playSong, setQueue, addToQueue } = usePlayerStore();\r\n  const { addToast } = useToastStore();\r\n\r\n  // Close menu on outside click\r\n  useEffect(() => {\r\n    const handleClickOutside = (e: MouseEvent) => {\r\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\r\n        setShowMenu(false);\r\n      }\r\n    };\r\n    if (showMenu) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }\r\n  }, [showMenu]);\r\n\r\n  const handlePlayAlbum = async (e?: React.MouseEvent) => {\r\n    e?.stopPropagation();\r\n    try {\r\n      const songs = await getAlbumSongs(album.id);\r\n      if (songs.length > 0) {\r\n        setQueue(songs);\r\n        playSong(songs[0]);\r\n      }\r\n    } catch (err) {\r\n      addToast('Failed to play album', 'error');\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  const handleAddToQueue = async (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    try {\r\n      const songs = await getAlbumSongs(album.id);\r\n      songs.forEach(song => addToQueue(song));\r\n      addToast(`Added ${songs.length} songs to queue`);\r\n    } catch (err) {\r\n      addToast('Failed to add to queue', 'error');\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  const handleGoToArtist = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    if (album.artist) {\r\n      navigate(`/artists/${encodeURIComponent(album.artist)}`);\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"group cursor-pointer relative\"\r\n      onClick={() => navigate(`/albums/${album.id}`)}\r\n    >\r\n      {/* Album Art */}\r\n      <div className=\"aspect-square bg-gray-200 dark:bg-white/5 rounded-lg shadow-sm overflow-hidden relative border border-black/5 dark:border-white/5 group-hover:shadow-md transition-all\">\r\n        {!imageError ? (\r\n          <img\r\n            src={getCoverUrl(album.id)}\r\n            alt={album.title}\r\n            className=\"w-full h-full object-cover transition duration-500 group-hover:scale-105\"\r\n            loading=\"lazy\"\r\n            onError={() => setImageError(true)}\r\n          />\r\n        ) : (\r\n          <div className=\"w-full h-full flex items-center justify-center text-gray-400 bg-gray-100 dark:bg-white/5\">\r\n            <Disc size={40} />\r\n          </div>\r\n        )}\r\n\r\n        {/* Hover overlay with play button */}\r\n        <div className=\"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\r\n          <button\r\n            onClick={handlePlayAlbum}\r\n            className=\"w-12 h-12 rounded-full bg-apple-accent text-white flex items-center justify-center shadow-lg transform scale-90 group-hover:scale-100 transition\"\r\n          >\r\n            <Play size={20} fill=\"white\" className=\"ml-0.5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* 3-dot menu */}\r\n        <div ref={menuRef} className=\"absolute top-2 right-2\">\r\n          <button\r\n            onClick={(e) => { e.stopPropagation(); setShowMenu(!showMenu); }}\r\n            className=\"p-1.5 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition hover:bg-black/70\"\r\n          >\r\n            <MoreVertical size={16} />\r\n          </button>\r\n\r\n          {showMenu && (\r\n            <div\r\n              className=\"absolute right-0 top-8 w-44 bg-white dark:bg-[#2c2c2e] rounded-xl shadow-2xl border border-gray-200 dark:border-white/10 py-1.5 z-50 animate-in fade-in zoom-in-95 duration-100\"\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <button\r\n                onClick={handlePlayAlbum}\r\n                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n              >\r\n                <Play size={14} className=\"text-apple-subtext\" />\r\n                Play Album\r\n              </button>\r\n              <button\r\n                onClick={handleAddToQueue}\r\n                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n              >\r\n                <ListPlus size={14} className=\"text-apple-subtext\" />\r\n                Add to Queue\r\n              </button>\r\n              <div className=\"h-px bg-gray-100 dark:bg-white/10 my-1\" />\r\n              <button\r\n                onClick={handleGoToArtist}\r\n                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n              >\r\n                <User size={14} className=\"text-apple-subtext\" />\r\n                Go to Artist\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Album Info */}\r\n      <div className=\"mt-3\">\r\n        <h3 className=\"text-sm font-medium text-apple-text truncate group-hover:text-apple-accent transition-colors\">\r\n          {album.title}\r\n        </h3>\r\n        <p className=\"text-xs text-apple-subtext truncate\">\r\n          <ArtistLink name={album.artist} />\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Main Page ---\r\nexport function AlbumsPage() {\r\n  const [sortBy, setSortBy] = useState<SortField>('title');\r\n  const [sortOrder, setSortOrder] = useState<SortOrder>('asc');\r\n  const [showSortMenu, setShowSortMenu] = useState(false);\r\n  const menuRef = useRef<HTMLDivElement>(null);\r\n\r\n  const { data: albums, isLoading } = useQuery({\r\n    queryKey: ['albums'],\r\n    queryFn: () => getAlbums(0, 1000),\r\n  });\r\n\r\n  // Close menu on outside click\r\n  useEffect(() => {\r\n    const handleClickOutside = (e: MouseEvent) => {\r\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\r\n        setShowSortMenu(false);\r\n      }\r\n    };\r\n    if (showSortMenu) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }\r\n  }, [showSortMenu]);\r\n\r\n  // Sort albums\r\n  const sortedAlbums = albums ? [...albums].sort((a, b) => {\r\n    let aVal = a[sortBy] || '';\r\n    let bVal = b[sortBy] || '';\r\n\r\n    if (typeof aVal === 'string') aVal = aVal.toLowerCase();\r\n    if (typeof bVal === 'string') bVal = bVal.toLowerCase();\r\n\r\n    if (sortOrder === 'asc') {\r\n      return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;\r\n    } else {\r\n      return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;\r\n    }\r\n  }) : [];\r\n\r\n  const handleSort = (field: SortField) => {\r\n    if (sortBy === field) {\r\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortBy(field);\r\n      setSortOrder('asc');\r\n    }\r\n    setShowSortMenu(false);\r\n  };\r\n\r\n  if (isLoading) return (\r\n    <div className=\"h-full flex flex-col bg-apple-gray\">\r\n      <header className=\"h-16 flex items-center px-8 sticky top-0 z-10 border-b border-gray-200 dark:border-white/10 bg-apple-gray/95 backdrop-blur flex-shrink-0\">\r\n        <h2 className=\"text-xl font-semibold text-apple-text\">Albums</h2>\r\n      </header>\r\n      <AlbumGridSkeleton count={18} />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col bg-apple-gray\">\r\n      <header className=\"h-16 flex items-center justify-between px-8 sticky top-0 z-10 border-b border-gray-200 dark:border-white/10 bg-apple-gray/95 backdrop-blur flex-shrink-0\">\r\n        <h2 className=\"text-xl font-semibold text-apple-text\">Albums</h2>\r\n\r\n        {/* Sort dropdown */}\r\n        <div ref={menuRef} className=\"relative\">\r\n          <button\r\n            onClick={() => setShowSortMenu(!showSortMenu)}\r\n            className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm text-apple-subtext hover:text-apple-text hover:bg-gray-200 dark:hover:bg-white/10 transition\"\r\n          >\r\n            <ArrowUpDown size={14} />\r\n            <span className=\"hidden sm:inline\">Sort by {sortBy}</span>\r\n          </button>\r\n\r\n          {showSortMenu && (\r\n            <div className=\"absolute right-0 top-10 w-40 bg-white dark:bg-[#2c2c2e] rounded-xl shadow-2xl border border-gray-200 dark:border-white/10 py-1.5 z-50 animate-in fade-in zoom-in-95 duration-100\">\r\n              <SortOption label=\"Title\" field=\"title\" currentSort={sortBy} sortOrder={sortOrder} onClick={handleSort} />\r\n              <SortOption label=\"Artist\" field=\"artist\" currentSort={sortBy} sortOrder={sortOrder} onClick={handleSort} />\r\n              <SortOption label=\"Year\" field=\"year\" currentSort={sortBy} sortOrder={sortOrder} onClick={handleSort} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"flex-1 overflow-y-auto p-8 pb-32\">\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6\">\r\n          {sortedAlbums.map((album) => (\r\n            <AlbumCard key={album.id} album={album} />\r\n          ))}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Sort option helper\r\nfunction SortOption({\r\n  label,\r\n  field,\r\n  currentSort,\r\n  sortOrder,\r\n  onClick\r\n}: {\r\n  label: string;\r\n  field: SortField;\r\n  currentSort: SortField;\r\n  sortOrder: SortOrder;\r\n  onClick: (field: SortField) => void;\r\n}) {\r\n  const isActive = currentSort === field;\r\n  return (\r\n    <button\r\n      onClick={() => onClick(field)}\r\n      className=\"w-full flex items-center justify-between px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n    >\r\n      <span className={isActive ? 'text-apple-accent font-medium' : 'text-apple-text'}>{label}</span>\r\n      {isActive && (\r\n        <span className=\"text-apple-accent text-xs\">\r\n          {sortOrder === 'asc' ? 'Γåæ' : 'Γåô'}\r\n        </span>\r\n      )}\r\n    </button>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\AllPlaylistsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[752,755],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[752,755],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1207,1210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1207,1210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1477,1480],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1477,1480],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1940,1943],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1940,1943],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { getPlaylists, deletePlaylist, renamePlaylist, getPlaylistSongs, getCoverUrl } from '../lib/api';\r\nimport { Plus, MoreVertical, Trash2, Edit2, ListMusic, Play } from 'lucide-react';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { useToastStore } from '../stores/toastStore';\r\nimport { CreatePlaylistModal } from '../components/CreatePlaylistModal';\r\nimport { PlaylistGridSkeleton } from '../components/Skeletons';\r\nimport { useConfirm } from '../stores/confirmStore';\r\n\r\n// --- Sub-Component for Individual Playlist Card ---\r\nfunction PlaylistCard({ playlist }: { playlist: any }) {\r\n  const navigate = useNavigate();\r\n  const { playSong, setQueue } = usePlayerStore();\r\n  const { addToast } = useToastStore();\r\n  const queryClient = useQueryClient();\r\n  const [showMenu, setShowMenu] = useState(false);\r\n\r\n  // Fetch first song to get cover art\r\n  const { data: songs } = useQuery({\r\n    queryKey: ['playlist-songs', playlist.id],\r\n    queryFn: () => getPlaylistSongs(playlist.id.toString()),\r\n  });\r\n\r\n  const handlePlay = (e: any) => {\r\n    e.stopPropagation();\r\n    if (songs && songs.length > 0) {\r\n      setQueue(songs);\r\n      playSong(songs[0]);\r\n    } else {\r\n      addToast('Playlist is empty', 'error');\r\n    }\r\n  };\r\n\r\n  const confirm = useConfirm();\r\n\r\n  const handleDelete = async (e: any) => {\r\n    e.stopPropagation();\r\n    const confirmed = await confirm({\r\n      title: 'Delete Playlist',\r\n      message: `Are you sure you want to delete \"${playlist.name}\"?`,\r\n      confirmText: 'Delete',\r\n      variant: 'danger',\r\n    });\r\n\r\n    if (confirmed) {\r\n      await deletePlaylist(playlist.id);\r\n      queryClient.invalidateQueries({ queryKey: ['playlists'] });\r\n      addToast('Playlist deleted');\r\n    }\r\n  };\r\n\r\n  const handleRename = async (e: any) => {\r\n    e.stopPropagation();\r\n    const newName = prompt(\"Rename Playlist:\", playlist.name);\r\n    if (newName) {\r\n      await renamePlaylist(playlist.id, newName);\r\n      queryClient.invalidateQueries({ queryKey: ['playlists'] });\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  // Determine Cover Art (First song's album)\r\n  const coverArtId = songs?.[0]?.album_id;\r\n\r\n  return (\r\n    <div\r\n      className=\"group cursor-pointer relative\"\r\n      onClick={() => navigate(`/playlists/${playlist.id}`)}\r\n      onMouseLeave={() => setShowMenu(false)}\r\n    >\r\n      {/* Art Container */}\r\n      <div className=\"aspect-square bg-gray-200 dark:bg-white/5 rounded-lg shadow-sm overflow-hidden relative border border-black/5 dark:border-white/5 group-hover:shadow-md transition-all\">\r\n        {coverArtId ? (\r\n          <img\r\n            src={getCoverUrl(coverArtId)}\r\n            alt={playlist.name}\r\n            className=\"w-full h-full object-cover transition duration-500 group-hover:scale-105\"\r\n            loading=\"lazy\"\r\n          />\r\n        ) : (\r\n          <div className=\"w-full h-full flex items-center justify-center text-apple-subtext bg-gray-100 dark:bg-white/5\">\r\n            <ListMusic size={48} className=\"opacity-50\" />\r\n          </div>\r\n        )}\r\n\r\n        {/* Play Overlay */}\r\n        <div className=\"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition flex items-center justify-center\">\r\n          <button\r\n            onClick={handlePlay}\r\n            className=\"w-12 h-12 bg-apple-accent text-white rounded-full flex items-center justify-center shadow-lg transform scale-90 group-hover:scale-100 transition hover:bg-apple-accent/90\"\r\n          >\r\n            <Play size={24} fill=\"currentColor\" className=\"ml-1\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Menu Button (Top Right) */}\r\n        <button\r\n          onClick={(e) => { e.stopPropagation(); setShowMenu(!showMenu); }}\r\n          className={`absolute top-2 right-2 p-1.5 rounded-full bg-black/50 text-white backdrop-blur-md transition ${showMenu ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'}`}\r\n        >\r\n          <MoreVertical size={16} />\r\n        </button>\r\n\r\n        {/* Dropdown Menu */}\r\n        {showMenu && (\r\n          <div className=\"absolute top-10 right-2 w-32 bg-white dark:bg-[#2c2c2e] rounded-lg shadow-xl border border-gray-200 dark:border-white/10 py-1 z-20 animate-in fade-in zoom-in-95 duration-100\">\r\n            <button onClick={handleRename} className=\"w-full text-left px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 flex items-center gap-2\">\r\n              <Edit2 size={14} /> Rename\r\n            </button>\r\n            <button onClick={handleDelete} className=\"w-full text-left px-3 py-2 text-sm text-red-500 hover:bg-gray-100 dark:hover:bg-white/10 flex items-center gap-2\">\r\n              <Trash2 size={14} /> Delete\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Text Info */}\r\n      <div className=\"mt-3\">\r\n        <h3 className=\"font-medium text-apple-text truncate\">{playlist.name}</h3>\r\n        <p className=\"text-xs text-apple-subtext\">{songs?.length || 0} Songs</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Main Page Component ---\r\nexport function AllPlaylistsPage() {\r\n  const { data: playlists, isLoading } = useQuery({\r\n    queryKey: ['playlists'],\r\n    queryFn: getPlaylists,\r\n  });\r\n\r\n  const [isCreating, setIsCreating] = useState(false);\r\n\r\n  if (isLoading) return (\r\n    <div className=\"h-full flex flex-col bg-apple-gray\">\r\n      <header className=\"h-16 flex items-center px-8 border-b border-gray-200 dark:border-white/10 bg-apple-gray/95 backdrop-blur z-10\">\r\n        <h2 className=\"text-xl font-semibold text-apple-text\">All Playlists</h2>\r\n      </header>\r\n      <PlaylistGridSkeleton count={8} />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col bg-apple-gray\">\r\n      <header className=\"h-16 flex items-center px-8 border-b border-gray-200 dark:border-white/10 bg-apple-gray/95 backdrop-blur z-10\">\r\n        <h2 className=\"text-xl font-semibold text-apple-text\">All Playlists</h2>\r\n      </header>\r\n\r\n      <main className=\"flex-1 overflow-y-auto p-8 pb-32\">\r\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6\">\r\n\r\n          {/* 1. Existing Playlists */}\r\n          {playlists?.map((playlist) => (\r\n            <PlaylistCard key={playlist.id} playlist={playlist} />\r\n          ))}\r\n\r\n          {/* 2. The \"Create New\" Card */}\r\n          <button\r\n            onClick={() => setIsCreating(true)}\r\n            className=\"group aspect-square rounded-lg border-2 border-dashed border-gray-300 dark:border-white/10 flex flex-col items-center justify-center hover:border-apple-accent hover:bg-apple-accent/5 transition cursor-pointer\"\r\n          >\r\n            <div className=\"w-16 h-16 rounded-full bg-gray-200 dark:bg-white/5 flex items-center justify-center text-apple-subtext group-hover:text-apple-accent group-hover:bg-apple-accent/10 transition\">\r\n              <Plus size={32} />\r\n            </div>\r\n            <span className=\"mt-4 font-medium text-apple-subtext group-hover:text-apple-accent\">Create New</span>\r\n          </button>\r\n\r\n        </div>\r\n      </main>\r\n\r\n      {/* Render Modal */}\r\n      {isCreating && <CreatePlaylistModal onClose={() => setIsCreating(false)} />}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\ArtistDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\ArtistsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[653,656],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[653,656],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":42,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":58,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2484,2487],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2484,2487],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":72,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":17}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { getArtists, getCoverUrl, getArtistWork } from '../lib/api';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { useToastStore } from '../stores/toastStore';\r\nimport { Mic2, MoreVertical, Play, ListPlus, ArrowUpDown, Shuffle } from 'lucide-react';\r\nimport { ArtistGridSkeleton } from '../components/Skeletons';\r\n\r\ntype SortField = 'name' | 'album_count';\r\ntype SortOrder = 'asc' | 'desc';\r\n\r\n// --- Artist Card with Context Menu ---\r\nfunction ArtistCard({ artist }: { artist: any }) {\r\n  const navigate = useNavigate();\r\n  const [showMenu, setShowMenu] = useState(false);\r\n  const menuRef = useRef<HTMLDivElement>(null);\r\n  const { playSong, setQueue, addToQueue } = usePlayerStore();\r\n  const { addToast } = useToastStore();\r\n\r\n  // Close menu on outside click\r\n  useEffect(() => {\r\n    const handleClickOutside = (e: MouseEvent) => {\r\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\r\n        setShowMenu(false);\r\n      }\r\n    };\r\n    if (showMenu) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }\r\n  }, [showMenu]);\r\n\r\n  const handlePlayArtist = async (e?: React.MouseEvent) => {\r\n    e?.stopPropagation();\r\n    try {\r\n      const work = await getArtistWork(artist.name);\r\n      if (work.songs && work.songs.length > 0) {\r\n        setQueue(work.songs);\r\n        playSong(work.songs[0]);\r\n      }\r\n    } catch (err) {\r\n      addToast('Failed to play artist', 'error');\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  const handleShuffleArtist = async (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    try {\r\n      const work = await getArtistWork(artist.name);\r\n      if (work.songs && work.songs.length > 0) {\r\n        const shuffled = [...work.songs].sort(() => Math.random() - 0.5);\r\n        setQueue(shuffled);\r\n        usePlayerStore.setState({ isShuffle: true, originalQueue: work.songs });\r\n        playSong(shuffled[0]);\r\n      }\r\n    } catch (err) {\r\n      addToast('Failed to shuffle artist', 'error');\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  const handleAddToQueue = async (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    try {\r\n      const work = await getArtistWork(artist.name);\r\n      if (work.songs) {\r\n        work.songs.forEach((song: any) => addToQueue(song));\r\n        addToast(`Added ${work.songs.length} songs to queue`);\r\n      }\r\n    } catch (err) {\r\n      addToast('Failed to add to queue', 'error');\r\n    }\r\n    setShowMenu(false);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"group cursor-pointer text-center space-y-3 relative\"\r\n      onClick={() => navigate(`/artists/${encodeURIComponent(artist.name)}`)}\r\n    >\r\n      {/* Artist Image */}\r\n      <div className=\"aspect-square rounded-full overflow-hidden bg-gray-200 dark:bg-white/5 shadow-md border border-white/10 mx-auto w-full max-w-[200px] relative group-hover:shadow-lg transition-all\">\r\n        <img\r\n          src={getCoverUrl(artist.cover_example)}\r\n          className=\"w-full h-full object-cover group-hover:scale-110 transition duration-500\"\r\n          onError={(e) => e.currentTarget.style.display = 'none'}\r\n        />\r\n        <div className=\"absolute inset-0 flex items-center justify-center -z-10\">\r\n          <Mic2 size={40} className=\"text-gray-400\" />\r\n        </div>\r\n\r\n        {/* Hover overlay with play button */}\r\n        <div className=\"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-full\">\r\n          <button\r\n            onClick={handlePlayArtist}\r\n            className=\"w-12 h-12 rounded-full bg-apple-accent text-white flex items-center justify-center shadow-lg transform scale-90 group-hover:scale-100 transition\"\r\n          >\r\n            <Play size={20} fill=\"white\" className=\"ml-0.5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* 3-dot menu */}\r\n        <div ref={menuRef} className=\"absolute top-2 right-2\">\r\n          <button\r\n            onClick={(e) => { e.stopPropagation(); setShowMenu(!showMenu); }}\r\n            className=\"p-1.5 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition hover:bg-black/70\"\r\n          >\r\n            <MoreVertical size={16} />\r\n          </button>\r\n\r\n          {showMenu && (\r\n            <div\r\n              className=\"absolute right-0 top-8 w-44 bg-white dark:bg-[#2c2c2e] rounded-xl shadow-2xl border border-gray-200 dark:border-white/10 py-1.5 z-50 animate-in fade-in zoom-in-95 duration-100\"\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <button\r\n                onClick={handlePlayArtist}\r\n                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n              >\r\n                <Play size={14} className=\"text-apple-subtext\" />\r\n                Play All\r\n              </button>\r\n              <button\r\n                onClick={handleShuffleArtist}\r\n                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n              >\r\n                <Shuffle size={14} className=\"text-apple-subtext\" />\r\n                Shuffle All\r\n              </button>\r\n              <button\r\n                onClick={handleAddToQueue}\r\n                className=\"w-full flex items-center gap-3 px-3 py-2 text-sm text-apple-text hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n              >\r\n                <ListPlus size={14} className=\"text-apple-subtext\" />\r\n                Add to Queue\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Artist Info */}\r\n      <div>\r\n        <h3 className=\"font-medium text-apple-text truncate group-hover:text-apple-accent transition\">{artist.name}</h3>\r\n        <p className=\"text-xs text-apple-subtext\">{artist.album_count} Albums</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Main Page ---\r\nexport function ArtistsPage() {\r\n  const [sortBy, setSortBy] = useState<SortField>('name');\r\n  const [sortOrder, setSortOrder] = useState<SortOrder>('asc');\r\n  const [showSortMenu, setShowSortMenu] = useState(false);\r\n  const menuRef = useRef<HTMLDivElement>(null);\r\n\r\n  const { data: artists, isLoading } = useQuery({\r\n    queryKey: ['artists'],\r\n    queryFn: getArtists,\r\n  });\r\n\r\n  // Close menu on outside click\r\n  useEffect(() => {\r\n    const handleClickOutside = (e: MouseEvent) => {\r\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\r\n        setShowSortMenu(false);\r\n      }\r\n    };\r\n    if (showSortMenu) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }\r\n  }, [showSortMenu]);\r\n\r\n  // Sort artists\r\n  const sortedArtists = artists ? [...artists].sort((a, b) => {\r\n    let aVal = a[sortBy];\r\n    let bVal = b[sortBy];\r\n\r\n    if (typeof aVal === 'string') aVal = aVal.toLowerCase();\r\n    if (typeof bVal === 'string') bVal = bVal.toLowerCase();\r\n\r\n    if (sortOrder === 'asc') {\r\n      return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;\r\n    } else {\r\n      return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;\r\n    }\r\n  }) : [];\r\n\r\n  const handleSort = (field: SortField) => {\r\n    if (sortBy === field) {\r\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortBy(field);\r\n      setSortOrder('asc');\r\n    }\r\n    setShowSortMenu(false);\r\n  };\r\n\r\n  if (isLoading) return (\r\n    <div className=\"h-full flex flex-col\">\r\n      <header className=\"h-16 flex items-center px-8 border-b border-gray-200 dark:border-white/10 bg-apple-gray/95 backdrop-blur z-10\">\r\n        <h2 className=\"text-xl font-semibold text-apple-text\">Artists</h2>\r\n      </header>\r\n      <ArtistGridSkeleton count={15} />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      <header className=\"h-16 flex items-center justify-between px-8 border-b border-gray-200 dark:border-white/10 bg-apple-gray/95 backdrop-blur z-10\">\r\n        <h2 className=\"text-xl font-semibold text-apple-text\">Artists</h2>\r\n\r\n        {/* Sort dropdown */}\r\n        <div ref={menuRef} className=\"relative\">\r\n          <button\r\n            onClick={() => setShowSortMenu(!showSortMenu)}\r\n            className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm text-apple-subtext hover:text-apple-text hover:bg-gray-200 dark:hover:bg-white/10 transition\"\r\n          >\r\n            <ArrowUpDown size={14} />\r\n            <span className=\"hidden sm:inline\">Sort</span>\r\n          </button>\r\n\r\n          {showSortMenu && (\r\n            <div className=\"absolute right-0 top-10 w-40 bg-white dark:bg-[#2c2c2e] rounded-xl shadow-2xl border border-gray-200 dark:border-white/10 py-1.5 z-50 animate-in fade-in zoom-in-95 duration-100\">\r\n              <SortOption label=\"Name\" field=\"name\" currentSort={sortBy} sortOrder={sortOrder} onClick={handleSort} />\r\n              <SortOption label=\"Album Count\" field=\"album_count\" currentSort={sortBy} sortOrder={sortOrder} onClick={handleSort} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"flex-1 overflow-y-auto p-8 pb-32\">\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6\">\r\n          {sortedArtists.map((artist) => (\r\n            <ArtistCard key={artist.name} artist={artist} />\r\n          ))}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Sort option helper\r\nfunction SortOption({\r\n  label,\r\n  field,\r\n  currentSort,\r\n  sortOrder,\r\n  onClick\r\n}: {\r\n  label: string;\r\n  field: SortField;\r\n  currentSort: SortField;\r\n  sortOrder: SortOrder;\r\n  onClick: (field: SortField) => void;\r\n}) {\r\n  const isActive = currentSort === field;\r\n  return (\r\n    <button\r\n      onClick={() => onClick(field)}\r\n      className=\"w-full flex items-center justify-between px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-white/10 transition\"\r\n    >\r\n      <span className={isActive ? 'text-apple-accent font-medium' : 'text-apple-text'}>{label}</span>\r\n      {isActive && (\r\n        <span className=\"text-apple-accent text-xs\">\r\n          {sortOrder === 'asc' ? 'Γåæ' : 'Γåô'}\r\n        </span>\r\n      )}\r\n    </button>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\LibraryPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\PlaylistDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1347,1350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1347,1350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useParams, useNavigate } from 'react-router-dom';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { getPlaylistSongs, getPlaylists, deletePlaylist, getCoverUrl } from '../lib/api';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { useThemeStore } from '../stores/themeStore';\r\nimport { useToastStore } from '../stores/toastStore';\r\nimport { formatTime, cn } from '../lib/utils';\r\nimport { Play, Trash2, Music, ListMusic, Shuffle } from 'lucide-react';\r\nimport { SongListSkeleton } from '../components/Skeletons';\r\nimport { useConfirm } from '../stores/confirmStore';\r\n\r\nexport function PlaylistDetail() {\r\n  const { id } = useParams<{ id: string }>();\r\n  const navigate = useNavigate();\r\n  const queryClient = useQueryClient();\r\n  const { addToast } = useToastStore();\r\n\r\n  const { playSong, setQueue, currentSong } = usePlayerStore();\r\n  const { showSongListArt } = useThemeStore();\r\n\r\n  // 1. Get Playlist Metadata (Name)\r\n  const { data: playlists } = useQuery({ queryKey: ['playlists'], queryFn: getPlaylists });\r\n  const playlistInfo = playlists?.find(p => p.id === Number(id));\r\n\r\n  // 2. Get Songs\r\n  const { data: songs, isLoading } = useQuery({\r\n    queryKey: ['playlist-songs', id],\r\n    queryFn: () => getPlaylistSongs(id!),\r\n    enabled: !!id,\r\n  });\r\n\r\n  const handlePlay = (song: any) => {\r\n    if (songs) setQueue(songs);\r\n    playSong(song);\r\n  };\r\n\r\n  const handlePlayAll = () => {\r\n    if (songs && songs.length > 0) {\r\n      setQueue(songs);\r\n      usePlayerStore.setState({ isShuffle: false });\r\n      playSong(songs[0]);\r\n    }\r\n  };\r\n\r\n  const handleShuffleAll = () => {\r\n    if (songs && songs.length > 0) {\r\n      const shuffled = [...songs].sort(() => Math.random() - 0.5);\r\n      usePlayerStore.setState({ isShuffle: true, queue: shuffled, originalQueue: songs });\r\n      playSong(shuffled[0]);\r\n    }\r\n  };\r\n\r\n  const confirm = useConfirm();\r\n\r\n  const handleDeletePlaylist = async () => {\r\n    const confirmed = await confirm({\r\n      title: 'Delete Playlist',\r\n      message: `Are you sure you want to delete \"${playlistInfo?.name}\"? This action cannot be undone.`,\r\n      confirmText: 'Delete',\r\n      variant: 'danger',\r\n    });\r\n\r\n    if (confirmed) {\r\n      await deletePlaylist(Number(id));\r\n      queryClient.invalidateQueries({ queryKey: ['playlists'] });\r\n      addToast('Playlist deleted');\r\n      navigate('/');\r\n    }\r\n  };\r\n\r\n  if (!playlistInfo) return <div className=\"p-8 text-apple-subtext\">Playlist not found</div>;\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col bg-apple-gray overflow-hidden\">\r\n\r\n      {/* Header Section */}\r\n      <div className=\"p-8 pb-6 flex items-end gap-6 border-b border-gray-200 dark:border-white/10 flex-shrink-0 bg-apple-gray z-10\">\r\n        <div className=\"w-32 h-32 sm:w-40 sm:h-40 bg-gradient-to-br from-pink-500 to-orange-400 rounded-lg shadow-xl flex items-center justify-center text-white\">\r\n          {/* Use cover of first song if available, else icon */}\r\n          {songs && songs.length > 0 && songs[0].album_id ? (\r\n            <img src={getCoverUrl(songs[0].album_id)} className=\"w-full h-full object-cover rounded-lg\" />\r\n          ) : (\r\n            <ListMusic size={48} />\r\n          )}\r\n        </div>\r\n        <div className=\"flex-1 mb-1\">\r\n          <h5 className=\"text-xs font-bold text-apple-accent uppercase tracking-widest mb-1\">Playlist</h5>\r\n          <h1 className=\"text-3xl sm:text-5xl font-bold text-apple-text mb-3\">{playlistInfo.name}</h1>\r\n          <div className=\"flex items-center gap-3 text-apple-subtext text-sm font-medium\">\r\n            <span>{songs?.length || 0} Songs</span>\r\n            {songs && songs.length > 0 && (\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  onClick={handlePlayAll}\r\n                  className=\"px-4 py-1.5 bg-apple-accent text-white rounded-full font-semibold flex items-center gap-2 hover:opacity-90 transition text-sm shadow-lg\"\r\n                >\r\n                  <Play size={14} fill=\"currentColor\" /> Play\r\n                </button>\r\n                <button\r\n                  onClick={handleShuffleAll}\r\n                  className=\"px-4 py-1.5 bg-gray-200 dark:bg-white/10 text-apple-text rounded-full font-semibold flex items-center gap-2 hover:bg-gray-300 dark:hover:bg-white/20 transition text-sm\"\r\n                >\r\n                  <Shuffle size={14} /> Shuffle\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        <button\r\n          onClick={handleDeletePlaylist}\r\n          className=\"p-2 text-apple-subtext hover:text-red-500 transition mb-2 bg-gray-100 dark:bg-white/5 rounded-lg\"\r\n          title=\"Delete Playlist\"\r\n        >\r\n          <Trash2 size={20} />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Song List Table */}\r\n      <div className=\"flex-1 overflow-y-auto pb-32\">\r\n        {isLoading ? (\r\n          <SongListSkeleton count={8} />\r\n        ) : songs?.length === 0 ? (\r\n          <div className=\"p-12 text-center text-apple-subtext\">This playlist is empty. Add songs from the Library.</div>\r\n        ) : (\r\n          <div className=\"w-full\">\r\n            <div className=\"flex items-center px-8 py-2 text-xs font-semibold text-apple-subtext uppercase tracking-wider sticky top-0 bg-apple-gray/95 backdrop-blur z-10\">\r\n              <div className=\"w-8 text-center\">#</div>\r\n              {showSongListArt && <div className=\"w-12\"></div>}\r\n              <div className=\"flex-1 pl-4\">Title</div>\r\n              <div className=\"w-1/3 hidden md:block\">Artist</div>\r\n              <div className=\"w-16 text-right\">Time</div>\r\n            </div>\r\n\r\n            {songs?.map((song, index) => {\r\n              const isActive = currentSong?.id === song.id;\r\n              return (\r\n                <div\r\n                  key={`${song.id}-${index}`} // index key needed as duplicates allowed in playlists\r\n                  className={cn(\r\n                    \"flex items-center px-8 py-2 hover:bg-gray-200/50 dark:hover:bg-white/5 cursor-pointer group transition-colors border-b border-gray-100 dark:border-white/5 h-14\",\r\n                    isActive && \"bg-gray-200 dark:bg-white/10\"\r\n                  )}\r\n                  onClick={() => handlePlay(song)}\r\n                >\r\n                  <div className=\"w-8 text-center text-sm text-apple-subtext relative flex-shrink-0\">\r\n                    <span className={cn(\"group-hover:hidden\", isActive && \"text-apple-accent font-bold\")}>{index + 1}</span>\r\n                    <span className=\"hidden group-hover:flex items-center justify-center absolute inset-0\">\r\n                      <Play size={12} fill=\"currentColor\" className={isActive ? \"text-apple-accent\" : \"text-apple-text\"} />\r\n                    </span>\r\n                  </div>\r\n\r\n                  {showSongListArt && (\r\n                    <div className=\"w-12 flex-shrink-0 flex justify-center\">\r\n                      <div className=\"w-9 h-9 rounded overflow-hidden bg-gray-200 dark:bg-white/10 relative border border-black/5\">\r\n                        {song.album_id ? (\r\n                          <img src={getCoverUrl(song.album_id)} className=\"w-full h-full object-cover\" loading=\"lazy\" />\r\n                        ) : <Music size={14} className=\"m-auto text-gray-400\" />}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  <div className=\"flex-1 min-w-0 pl-4 pr-4\">\r\n                    <div className={cn(\"font-medium truncate text-sm\", isActive ? \"text-apple-accent\" : \"text-apple-text\")}>\r\n                      {song.title}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"w-1/3 hidden md:block text-sm text-apple-subtext truncate\">{song.artist}</div>\r\n                  <div className=\"w-16 text-right text-sm text-apple-subtext tabular-nums\">{formatTime(song.duration)}</div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\SearchPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[519,522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[519,522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[537,540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[537,540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1318,1321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1318,1321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1442,1445],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1442,1445],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1703,1706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1703,1706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { getCoverUrl } from '../lib/api';\r\nimport { usePlayerStore } from '../stores/playerStore';\r\nimport { formatTime, cn } from '../lib/utils';\r\nimport { Music, Search, Disc, User, Play } from 'lucide-react';\r\nimport api from '../lib/api';\r\nimport { SearchPageSkeleton } from '../components/Skeletons';\r\nimport { ArtistLink } from '../components/ContextMenu';\r\n\r\ninterface SearchResults {\r\n  songs: any[];\r\n  albums: any[];\r\n  artists: { name: string }[];\r\n  bestMatchType?: 'song' | 'album' | 'artist' | null;\r\n  scores?: {\r\n    song: number;\r\n    album: number;\r\n    artist: number;\r\n  };\r\n}\r\n\r\nexport function SearchPage() {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const query = searchParams.get('q') || '';\r\n\r\n  const { data: results, isLoading } = useQuery<SearchResults>({\r\n    queryKey: ['search', query],\r\n    queryFn: async () => {\r\n      if (!query) return { songs: [], albums: [], artists: [] };\r\n      const res = await api.get(`/library/search?q=${encodeURIComponent(query)}`);\r\n      return res.data;\r\n    },\r\n    enabled: !!query,\r\n  });\r\n\r\n  const { playSong, setQueue, currentSong } = usePlayerStore();\r\n\r\n  const handlePlaySong = (song: any) => {\r\n    if (results?.songs) setQueue(results.songs);\r\n    playSong(song);\r\n  };\r\n\r\n  const handlePlayAlbum = (album: any) => {\r\n    navigate(`/albums/${album.id}`);\r\n  };\r\n\r\n  const handleViewArtist = (artist: { name: string }) => {\r\n    navigate(`/artists/${encodeURIComponent(artist.name)}`);\r\n  };\r\n\r\n  // Determine top result using backend's bestMatchType\r\n  let topResult: any = null;\r\n  let topResultType: 'song' | 'album' | 'artist' | null = null;\r\n\r\n  if (results && query) {\r\n    const bestType = results.bestMatchType;\r\n\r\n    if (bestType === 'song' && results.songs.length > 0) {\r\n      topResult = results.songs[0];\r\n      topResultType = 'song';\r\n    } else if (bestType === 'artist' && results.artists.length > 0) {\r\n      topResult = results.artists[0];\r\n      topResultType = 'artist';\r\n    } else if (bestType === 'album' && results.albums.length > 0) {\r\n      topResult = results.albums[0];\r\n      topResultType = 'album';\r\n    }\r\n    // Fallback logic if bestMatchType is not set (backwards compatibility)\r\n    else if (results.songs.length > 0) {\r\n      topResult = results.songs[0];\r\n      topResultType = 'song';\r\n    } else if (results.albums.length > 0) {\r\n      topResult = results.albums[0];\r\n      topResultType = 'album';\r\n    } else if (results.artists.length > 0) {\r\n      topResult = results.artists[0];\r\n      topResultType = 'artist';\r\n    }\r\n  }\r\n\r\n  // Get remaining items after top result\r\n  const remainingSongs = topResultType === 'song' ? results?.songs.slice(1) : results?.songs;\r\n  const remainingAlbums = topResultType === 'album' ? results?.albums.slice(1) : results?.albums;\r\n  const remainingArtists = topResultType === 'artist' ? results?.artists.slice(1) : results?.artists;\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col bg-apple-gray\">\r\n      <header className=\"h-16 flex items-center px-8 border-b border-gray-200 dark:border-white/10 flex-shrink-0\">\r\n        <h2 className=\"text-xl font-semibold text-apple-text\">Search</h2>\r\n      </header>\r\n\r\n      <main className=\"flex-1 overflow-y-auto p-8 pb-32\">\r\n        {!query ? (\r\n          <div className=\"h-full flex flex-col items-center justify-center text-apple-subtext opacity-50\">\r\n            <Search size={64} className=\"mb-4\" />\r\n            <p>Type in the sidebar to search</p>\r\n          </div>\r\n        ) : isLoading ? (\r\n          <SearchPageSkeleton />\r\n        ) : !results || (results.songs.length === 0 && results.albums.length === 0 && results.artists.length === 0) ? (\r\n          <div className=\"p-12 text-center text-apple-subtext\">No results found for \"{query}\"</div>\r\n        ) : (\r\n          <div className=\"space-y-8\">\r\n            {/* Top Result */}\r\n            {topResult && (\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold text-apple-text mb-4\">Top Result</h3>\r\n\r\n                {/* Song Top Result */}\r\n                {topResultType === 'song' && (\r\n                  <div\r\n                    onClick={() => handlePlaySong(topResult)}\r\n                    className=\"flex items-center gap-6 p-6 rounded-xl bg-gradient-to-br from-apple-accent/10 to-transparent hover:from-apple-accent/20 cursor-pointer group transition-all border border-apple-accent/20\"\r\n                  >\r\n                    <div className=\"w-32 h-32 rounded-lg overflow-hidden shadow-xl flex-shrink-0 relative\">\r\n                      {topResult.album_id ? (\r\n                        <img\r\n                          src={getCoverUrl(topResult.album_id)}\r\n                          alt={topResult.title}\r\n                          className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\r\n                        />\r\n                      ) : (\r\n                        <div className=\"w-full h-full bg-gradient-to-br from-apple-accent/30 to-apple-accent/10 flex items-center justify-center\">\r\n                          <Music size={48} className=\"text-apple-accent\" />\r\n                        </div>\r\n                      )}\r\n                      <div className=\"absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition\">\r\n                        <div className=\"w-12 h-12 rounded-full bg-apple-accent flex items-center justify-center\">\r\n                          <Play size={20} fill=\"white\" className=\"text-white ml-0.5\" />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"text-4xl font-bold text-apple-text mb-2 truncate group-hover:text-apple-accent transition\">\r\n                        {topResult.title}\r\n                      </div>\r\n                      <div className=\"text-lg text-apple-subtext mb-3 truncate\">\r\n                        <ArtistLink name={topResult.artist} />\r\n                      </div>\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <div className=\"inline-flex items-center gap-2 px-3 py-1 bg-white dark:bg-gray-800 rounded-full text-xs font-medium text-apple-subtext\">\r\n                          <Music size={14} />\r\n                          Song\r\n                        </div>\r\n                        <span className=\"text-sm text-apple-subtext\">{formatTime(topResult.duration)}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Album Top Result */}\r\n                {topResultType === 'album' && (\r\n                  <div\r\n                    onClick={() => handlePlayAlbum(topResult)}\r\n                    className=\"flex items-center gap-6 p-6 rounded-xl bg-gradient-to-br from-apple-accent/10 to-transparent hover:from-apple-accent/20 cursor-pointer group transition-all border border-apple-accent/20\"\r\n                  >\r\n                    <div className=\"w-32 h-32 rounded-lg overflow-hidden shadow-xl flex-shrink-0\">\r\n                      <img\r\n                        src={getCoverUrl(topResult.id)}\r\n                        alt={topResult.title}\r\n                        className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"text-4xl font-bold text-apple-text mb-2 truncate group-hover:text-apple-accent transition\">\r\n                        {topResult.title}\r\n                      </div>\r\n                      <div className=\"text-lg text-apple-subtext mb-3 truncate\">\r\n                        <ArtistLink name={topResult.artist} />\r\n                      </div>\r\n                      <div className=\"inline-flex items-center gap-2 px-3 py-1 bg-white dark:bg-gray-800 rounded-full text-xs font-medium text-apple-subtext\">\r\n                        <Disc size={14} />\r\n                        Album\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Artist Top Result */}\r\n                {topResultType === 'artist' && (\r\n                  <div\r\n                    className=\"flex items-center gap-6 p-6 rounded-xl bg-gradient-to-br from-apple-accent/10 to-transparent hover:from-apple-accent/20 cursor-pointer group transition-all border border-apple-accent/20\"\r\n                    onClick={() => handleViewArtist(topResult)}\r\n                  >\r\n                    <div className=\"w-32 h-32 rounded-full bg-gradient-to-br from-apple-accent/30 to-apple-accent/10 flex items-center justify-center shadow-xl flex-shrink-0 group-hover:scale-105 transition-transform\">\r\n                      <User size={64} className=\"text-apple-accent\" />\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"text-4xl font-bold text-apple-text mb-2 truncate group-hover:text-apple-accent transition\">\r\n                        {topResult.name}\r\n                      </div>\r\n                      <div className=\"inline-flex items-center gap-2 px-3 py-1 bg-white dark:bg-gray-800 rounded-full text-xs font-medium text-apple-subtext mt-2\">\r\n                        <User size={14} />\r\n                        Artist\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Songs Section */}\r\n            {remainingSongs && remainingSongs.length > 0 && (\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold text-apple-text mb-4 flex items-center gap-2\">\r\n                  <Music size={20} className=\"text-apple-accent\" />\r\n                  Songs\r\n                </h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\r\n                  {remainingSongs.slice(0, 8).map((song) => {\r\n                    const isActive = currentSong?.id === song.id;\r\n                    return (\r\n                      <div\r\n                        key={song.id}\r\n                        className={cn(\r\n                          \"flex items-center gap-3 px-4 py-3 rounded-lg cursor-pointer group transition-all hover:bg-gray-200/50 dark:hover:bg-white/5\",\r\n                          isActive && \"bg-gray-200 dark:bg-white/10\"\r\n                        )}\r\n                        onClick={() => handlePlaySong(song)}\r\n                      >\r\n                        {/* Album Art */}\r\n                        <div className=\"w-12 h-12 rounded overflow-hidden bg-gray-200 dark:bg-white/10 relative flex-shrink-0 border border-black/5\">\r\n                          {song.album_id ? (\r\n                            <img src={getCoverUrl(song.album_id)} className=\"w-full h-full object-cover\" alt=\"\" />\r\n                          ) : <Music size={16} className=\"m-auto text-gray-400\" />}\r\n                          <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition\">\r\n                            <Play size={16} fill=\"white\" className=\"text-white\" />\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Info */}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className={cn(\"font-medium truncate text-sm\", isActive ? \"text-apple-accent\" : \"text-apple-text\")}>\r\n                            {song.title}\r\n                          </div>\r\n                          <div className=\"text-xs text-apple-subtext truncate\">\r\n                            <ArtistLink name={song.artist} />\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Duration */}\r\n                        <div className=\"text-xs text-apple-subtext font-variant-numeric tabular-nums\">\r\n                          {formatTime(song.duration)}\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n                {remainingSongs.length > 8 && (\r\n                  <div className=\"text-xs text-apple-subtext mt-3 text-center\">\r\n                    +{remainingSongs.length - 8} more songs\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Albums Section */}\r\n            {remainingAlbums && remainingAlbums.length > 0 && (\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold text-apple-text mb-4 flex items-center gap-2\">\r\n                  <Disc size={20} className=\"text-apple-accent\" />\r\n                  Albums\r\n                </h3>\r\n                <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4\">\r\n                  {remainingAlbums.map((album) => (\r\n                    <div\r\n                      key={album.id}\r\n                      onClick={() => handlePlayAlbum(album)}\r\n                      className=\"group cursor-pointer\"\r\n                    >\r\n                      <div className=\"aspect-square rounded-lg overflow-hidden bg-gray-200 dark:bg-white/10 mb-3 shadow-md group-hover:shadow-xl transition-all relative\">\r\n                        <img\r\n                          src={getCoverUrl(album.id)}\r\n                          alt={album.title}\r\n                          className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\r\n                        />\r\n                        <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition\">\r\n                          <div className=\"w-12 h-12 rounded-full bg-apple-accent flex items-center justify-center\">\r\n                            <Play size={20} fill=\"white\" className=\"text-white ml-0.5\" />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <h4 className=\"font-medium text-sm text-apple-text truncate group-hover:text-apple-accent transition\">\r\n                        {album.title}\r\n                      </h4>\r\n                      <p className=\"text-xs text-apple-subtext truncate\">\r\n                        <ArtistLink name={album.artist} />\r\n                      </p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Artists Section */}\r\n            {remainingArtists && remainingArtists.length > 0 && (\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold text-apple-text mb-4 flex items-center gap-2\">\r\n                  <User size={20} className=\"text-apple-accent\" />\r\n                  Artists\r\n                </h3>\r\n                <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4\">\r\n                  {remainingArtists.map((artist, idx) => (\r\n                    <div\r\n                      key={idx}\r\n                      onClick={() => handleViewArtist(artist)}\r\n                      className=\"flex flex-col items-center p-4 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-white/10 hover:border-apple-accent dark:hover:border-apple-accent cursor-pointer transition group\"\r\n                    >\r\n                      <div className=\"w-20 h-20 rounded-full bg-gradient-to-br from-apple-accent/20 to-apple-accent/5 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform\">\r\n                        <User size={32} className=\"text-apple-accent\" />\r\n                      </div>\r\n                      <div className=\"font-medium text-sm text-apple-text text-center truncate w-full group-hover:text-apple-accent transition\">\r\n                        {artist.name}\r\n                      </div>\r\n                      <div className=\"text-xs text-apple-subtext mt-1\">Artist</div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\pages\\SettingsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\stores\\confirmStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\stores\\playerStore.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'currentIndex' is assigned a value but never used.","line":119,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":119,"endColumn":36}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { persist, createJSONStorage } from 'zustand/middleware';\r\nimport { Song } from '../types';\r\n\r\ntype RepeatMode = 'off' | 'all' | 'one';\r\n\r\ninterface PlayerState {\r\n  isPlaying: boolean;\r\n  currentSong: Song | null;\r\n  volume: number;\r\n  queue: Song[];\r\n  originalQueue: Song[];\r\n  currentIndex: number;\r\n  repeatMode: RepeatMode;\r\n  isShuffle: boolean;\r\n\r\n  playSong: (song: Song) => void;\r\n  togglePlay: () => void;\r\n  setIsPlaying: (isPlaying: boolean) => void;\r\n  setVolume: (val: number) => void;\r\n  setQueue: (songs: Song[]) => void;\r\n  playNext: () => void;\r\n  playPrev: () => void;\r\n  toggleShuffle: () => void;\r\n  toggleRepeat: () => void;\r\n  reorderQueue: (oldIndex: number, newIndex: number) => void;\r\n  removeFromQueue: (index: number) => void;\r\n  addToQueue: (song: Song) => void;\r\n  clearQueue: () => void;\r\n}\r\n\r\nexport const usePlayerStore = create<PlayerState>()(\r\n  persist(\r\n    (set, get) => ({\r\n      isPlaying: false,\r\n      currentSong: null,\r\n      volume: 1,\r\n      queue: [],\r\n      originalQueue: [],\r\n      currentIndex: -1,\r\n      repeatMode: 'off',\r\n      isShuffle: false,\r\n\r\n      playSong: (song) => set({ currentSong: song, isPlaying: true }),\r\n\r\n      togglePlay: () => set((state) => ({ isPlaying: !state.isPlaying })),\r\n\r\n      setIsPlaying: (isPlaying) => set({ isPlaying }),\r\n\r\n      setVolume: (val) => set({ volume: val }),\r\n\r\n      setQueue: (songs) => set({ queue: songs, originalQueue: songs }),\r\n\r\n      toggleShuffle: () => {\r\n        const { isShuffle, originalQueue, currentSong } = get();\r\n        if (!isShuffle) {\r\n          const newQueue = [...originalQueue];\r\n          // Fisher-Yates Shuffle\r\n          for (let i = newQueue.length - 1; i > 0; i--) {\r\n            const j = Math.floor(Math.random() * (i + 1));\r\n            [newQueue[i], newQueue[j]] = [newQueue[j], newQueue[i]];\r\n          }\r\n          // Keep current song first\r\n          if (currentSong) {\r\n            const idx = newQueue.findIndex(s => s.id === currentSong.id);\r\n            if (idx > -1) {\r\n              newQueue.splice(idx, 1);\r\n              newQueue.unshift(currentSong);\r\n            }\r\n          }\r\n          set({ isShuffle: true, queue: newQueue });\r\n        } else {\r\n          set({ isShuffle: false, queue: originalQueue });\r\n        }\r\n      },\r\n\r\n      toggleRepeat: () => {\r\n        const modes: RepeatMode[] = ['off', 'all', 'one'];\r\n        const next = modes[(modes.indexOf(get().repeatMode) + 1) % modes.length];\r\n        set({ repeatMode: next });\r\n      },\r\n\r\n      playNext: () => {\r\n        const { queue, currentSong, repeatMode } = get();\r\n        if (!currentSong) return;\r\n\r\n        if (repeatMode === 'one') {\r\n          set({ isPlaying: true });\r\n          const audio = document.querySelector('audio');\r\n          if (audio) { audio.currentTime = 0; audio.play(); }\r\n          return;\r\n        }\r\n\r\n        const idx = queue.findIndex(s => s.id === currentSong.id);\r\n        if (idx < queue.length - 1) {\r\n          set({ currentSong: queue[idx + 1], isPlaying: true });\r\n        } else if (repeatMode === 'all') {\r\n          set({ currentSong: queue[0], isPlaying: true });\r\n        } else {\r\n          set({ isPlaying: false });\r\n        }\r\n      },\r\n\r\n      playPrev: () => {\r\n        const { queue, currentSong } = get();\r\n        if (!currentSong) return;\r\n        const idx = queue.findIndex(s => s.id === currentSong.id);\r\n        if (idx > 0) {\r\n          set({ currentSong: queue[idx - 1], isPlaying: true });\r\n        } else {\r\n          // If at start of list, restart song\r\n          const audio = document.querySelector('audio');\r\n          if (audio) audio.currentTime = 0;\r\n        }\r\n      },\r\n\r\n      // Queue management actions\r\n      reorderQueue: (oldIndex: number, newIndex: number) => {\r\n        const { queue, currentIndex, currentSong } = get();\r\n        const newQueue = [...queue];\r\n        const [removed] = newQueue.splice(oldIndex, 1);\r\n        newQueue.splice(newIndex, 0, removed);\r\n\r\n        // Update current index if needed\r\n        const newCurrentIndex = newQueue.findIndex(s => s.id === currentSong?.id);\r\n\r\n        set({ queue: newQueue, currentIndex: newCurrentIndex });\r\n      },\r\n\r\n      removeFromQueue: (index: number) => {\r\n        const { queue, currentSong } = get();\r\n        const newQueue = queue.filter((_, i) => i !== index);\r\n\r\n        // Update current index if needed\r\n        const newCurrentIndex = newQueue.findIndex(s => s.id === currentSong?.id);\r\n\r\n        set({ queue: newQueue, currentIndex: newCurrentIndex });\r\n      },\r\n\r\n      addToQueue: (song: Song) => {\r\n        const { queue, currentSong } = get();\r\n        const currentIdx = queue.findIndex(s => s.id === currentSong?.id);\r\n\r\n        // Insert after current song, or at end if no current song\r\n        const newQueue = [...queue];\r\n        if (currentIdx >= 0) {\r\n          newQueue.splice(currentIdx + 1, 0, song);\r\n        } else {\r\n          newQueue.push(song);\r\n        }\r\n\r\n        set({ queue: newQueue });\r\n      },\r\n\r\n      clearQueue: () => {\r\n        set({ queue: [], originalQueue: [], currentIndex: -1 });\r\n      },\r\n    }),\r\n    {\r\n      name: 'tremors-player-storage',\r\n      storage: createJSONStorage(() => localStorage),\r\n      partialize: (state) => ({\r\n        currentSong: state.currentSong,\r\n        volume: state.volume,\r\n        queue: state.queue,\r\n        originalQueue: state.originalQueue,\r\n        repeatMode: state.repeatMode,\r\n        isShuffle: state.isShuffle,\r\n      }),\r\n    }\r\n  )\r\n);","usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\stores\\themeStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\stores\\toastStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"Z:\\Antigravity\\tremors-music\\frontend\\src\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
